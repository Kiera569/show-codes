{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/Users/limengyu/Desktop/private/code/project/show-codes/components/Carbon.js\";\nimport _JSXStyle from \"styled-jsx/style\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport dynamic from 'next/dynamic';\nimport hljs from 'highlight.js/lib/core';\nimport javascript from 'highlight.js/lib/languages/javascript';\nimport debounce from 'lodash.debounce';\nimport ms from 'ms';\nimport { Controlled as CodeMirror } from 'react-codemirror2';\nhljs.registerLanguage('javascript', javascript);\nimport SpinnerWrapper from './SpinnerWrapper';\nimport WindowControls from './WindowControls';\nimport WidthHandler from './WidthHandler';\nimport { COLORS, LANGUAGES, LANGUAGE_MODE_HASH, LANGUAGE_NAME_HASH, LANGUAGE_MIME_HASH, DEFAULT_SETTINGS, THEMES_HASH } from '../lib/constants';\nconst SelectionEditor = dynamic(() => import('./SelectionEditor'), {\n  loading: () => null,\n  loadableGenerated: {\n    webpack: () => [require.resolveWeak('./SelectionEditor')],\n    modules: ['./SelectionEditor']\n  }\n});\nconst Watermark = dynamic(() => import('./svg/Watermark'), {\n  loading: () => null,\n  loadableGenerated: {\n    webpack: () => [require.resolveWeak('./svg/Watermark')],\n    modules: ['./svg/Watermark']\n  }\n});\n\nfunction searchLanguage(l) {\n  return LANGUAGE_NAME_HASH[l] || LANGUAGE_MODE_HASH[l] || LANGUAGE_MIME_HASH[l];\n}\n\nfunction noop() {}\n\nfunction getUnderline(underline) {\n  switch (underline) {\n    case 1:\n      return 'underline';\n\n    case 2:\n      /**\n       * Chrome will only round to the nearest wave, causing visual inconsistencies\n       * https://stackoverflow.com/questions/57559588/how-to-make-the-wavy-underline-extend-cover-all-the-characters-in-chrome\n       */\n      return `${COLORS.RED} wavy underline; text-decoration-skip-ink: none`;\n  }\n\n  return 'initial';\n}\n\nclass Carbon extends React.PureComponent {\n  constructor(...args) {\n    super(...args);\n\n    _defineProperty(this, \"state\", {});\n\n    _defineProperty(this, \"handleLanguageChange\", debounce((newCode, language) => {\n      if (language === 'auto') {\n        // try to set the language\n        const detectedLanguage = hljs.highlightAuto(newCode).language;\n        const languageMode = searchLanguage(detectedLanguage);\n\n        if (languageMode) {\n          return languageMode.mime || languageMode.mode;\n        }\n      }\n\n      const languageMode = searchLanguage(language);\n\n      if (languageMode) {\n        return languageMode.mime || languageMode.mode;\n      }\n\n      return language;\n    }, ms('300ms'), {\n      leading: true,\n      trailing: true\n    }));\n\n    _defineProperty(this, \"onBeforeChange\", (editor, meta, code) => {\n      if (!this.props.readOnly) {\n        this.props.onChange(code);\n      }\n    });\n\n    _defineProperty(this, \"onSelection\", (ed, data) => {\n      if (this.props.readOnly) {\n        return;\n      }\n\n      const selection = data.ranges[0];\n\n      if (selection.head.line === selection.anchor.line && selection.head.ch === selection.anchor.ch) {\n        return this.currentSelection = null;\n      }\n\n      if (selection.head.line + selection.head.ch > selection.anchor.line + selection.anchor.ch) {\n        this.currentSelection = {\n          from: selection.anchor,\n          to: selection.head\n        };\n      } else {\n        this.currentSelection = {\n          from: selection.head,\n          to: selection.anchor\n        };\n      }\n    });\n\n    _defineProperty(this, \"onMouseUp\", () => {\n      if (this.currentSelection) {\n        this.setState({\n          selectionAt: this.currentSelection\n        }, () => {\n          this.currentSelection = null;\n        });\n      } else {\n        this.setState({\n          selectionAt: null\n        });\n      }\n    });\n\n    _defineProperty(this, \"onSelectionChange\", changes => {\n      if (this.state.selectionAt) {\n        const css = [changes.bold != null && `font-weight: ${changes.bold ? 'bold' : 'initial'}`, changes.italics != null && `font-style: ${changes.italics ? 'italic' : 'initial'}`, changes.underline != null && `text-decoration: ${getUnderline(changes.underline)}`, changes.color != null && `color: ${changes.color} !important`].filter(Boolean).join('; ');\n\n        if (css) {\n          this.props.editorRef.current.editor.doc.markText(this.state.selectionAt.from, this.state.selectionAt.to, {\n            css\n          });\n        }\n      }\n    });\n  }\n\n  render() {\n    const config = _objectSpread(_objectSpread({}, DEFAULT_SETTINGS), this.props.config);\n\n    const languageMode = this.handleLanguageChange(this.props.children, config.language && config.language.toLowerCase());\n    const options = {\n      screenReaderLabel: 'Code editor',\n      lineNumbers: config.lineNumbers,\n      firstLineNumber: config.firstLineNumber,\n      mode: languageMode || 'plaintext',\n      theme: config.theme,\n      scrollbarStyle: null,\n      viewportMargin: Infinity,\n      lineWrapping: true,\n      smartIndent: true,\n      extraKeys: {\n        'Shift-Tab': 'indentLess'\n      },\n      readOnly: this.props.readOnly,\n      showInvisibles: config.hiddenCharacters\n    };\n    const backgroundImage = this.props.config.backgroundImage && this.props.config.backgroundImageSelection || this.props.config.backgroundImage;\n    const themeConfig = this.props.theme || THEMES_HASH[config.theme];\n    const light = themeConfig && themeConfig.light;\n    /* eslint-disable jsx-a11y/no-static-element-interactions */\n\n    const content = /*#__PURE__*/_jsxDEV(\"div\", {\n      className: _JSXStyle.dynamic([[\"3142620235\", [config.widthAdjustment ? '90px' : 'auto', config.widthAdjustment ? '1024px' : 'none', config.widthAdjustment ? '' : `width: ${config.width}px;`, config.paddingVertical, config.paddingHorizontal, config.paddingVertical, config.paddingHorizontal, this.props.config.backgroundMode === 'image' ? `background: url(${backgroundImage});\n                    background-size: cover;\n                    background-repeat: no-repeat;` : `background: ${this.props.config.backgroundColor || config.backgroundColor};\n                    background-size: auto;\n                    background-repeat: repeat;`, config.dropShadow ? `box-shadow: 0 ${config.dropShadowOffsetY} ${config.dropShadowBlurRadius} rgba(0, 0, 0, 0.55)` : '', config.lineNumbers ? 'padding-left: 12px;' : '', config.fontFamily, config.fontSize, config.lineHeight, COLORS.SECONDARY, this.props.readOnly ? 'hidden' : '']]]) + \" \" + \"container\",\n      children: [config.windowControls ? /*#__PURE__*/_jsxDEV(WindowControls, {\n        theme: config.windowTheme,\n        code: this.props.children,\n        copyable: this.props.copyable,\n        light: light\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 184,\n        columnNumber: 11\n      }, this) : null, /*#__PURE__*/_jsxDEV(CodeMirror, {\n        ref: this.props.editorRef,\n        className: `CodeMirror__container window-theme__${config.windowTheme}`,\n        value: this.props.children,\n        options: options,\n        onBeforeChange: this.onBeforeChange,\n        onGutterClick: this.props.onGutterClick,\n        onSelection: this.onSelection\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 191,\n        columnNumber: 9\n      }, this), config.watermark && /*#__PURE__*/_jsxDEV(Watermark, {\n        light: light\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 200,\n        columnNumber: 30\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: _JSXStyle.dynamic([[\"3142620235\", [config.widthAdjustment ? '90px' : 'auto', config.widthAdjustment ? '1024px' : 'none', config.widthAdjustment ? '' : `width: ${config.width}px;`, config.paddingVertical, config.paddingHorizontal, config.paddingVertical, config.paddingHorizontal, this.props.config.backgroundMode === 'image' ? `background: url(${backgroundImage});\n                    background-size: cover;\n                    background-repeat: no-repeat;` : `background: ${this.props.config.backgroundColor || config.backgroundColor};\n                    background-size: auto;\n                    background-repeat: repeat;`, config.dropShadow ? `box-shadow: 0 ${config.dropShadowOffsetY} ${config.dropShadowBlurRadius} rgba(0, 0, 0, 0.55)` : '', config.lineNumbers ? 'padding-left: 12px;' : '', config.fontFamily, config.fontSize, config.lineHeight, COLORS.SECONDARY, this.props.readOnly ? 'hidden' : '']]]) + \" \" + \"container-bg\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: _JSXStyle.dynamic([[\"3142620235\", [config.widthAdjustment ? '90px' : 'auto', config.widthAdjustment ? '1024px' : 'none', config.widthAdjustment ? '' : `width: ${config.width}px;`, config.paddingVertical, config.paddingHorizontal, config.paddingVertical, config.paddingHorizontal, this.props.config.backgroundMode === 'image' ? `background: url(${backgroundImage});\n                    background-size: cover;\n                    background-repeat: no-repeat;` : `background: ${this.props.config.backgroundColor || config.backgroundColor};\n                    background-size: auto;\n                    background-repeat: repeat;`, config.dropShadow ? `box-shadow: 0 ${config.dropShadowOffsetY} ${config.dropShadowBlurRadius} rgba(0, 0, 0, 0.55)` : '', config.lineNumbers ? 'padding-left: 12px;' : '', config.fontFamily, config.fontSize, config.lineHeight, COLORS.SECONDARY, this.props.readOnly ? 'hidden' : '']]]) + \" \" + \"white eliminateOnRender\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 202,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: _JSXStyle.dynamic([[\"3142620235\", [config.widthAdjustment ? '90px' : 'auto', config.widthAdjustment ? '1024px' : 'none', config.widthAdjustment ? '' : `width: ${config.width}px;`, config.paddingVertical, config.paddingHorizontal, config.paddingVertical, config.paddingHorizontal, this.props.config.backgroundMode === 'image' ? `background: url(${backgroundImage});\n                    background-size: cover;\n                    background-repeat: no-repeat;` : `background: ${this.props.config.backgroundColor || config.backgroundColor};\n                    background-size: auto;\n                    background-repeat: repeat;`, config.dropShadow ? `box-shadow: 0 ${config.dropShadowOffsetY} ${config.dropShadowBlurRadius} rgba(0, 0, 0, 0.55)` : '', config.lineNumbers ? 'padding-left: 12px;' : '', config.fontFamily, config.fontSize, config.lineHeight, COLORS.SECONDARY, this.props.readOnly ? 'hidden' : '']]]) + \" \" + \"alpha eliminateOnRender\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 203,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: _JSXStyle.dynamic([[\"3142620235\", [config.widthAdjustment ? '90px' : 'auto', config.widthAdjustment ? '1024px' : 'none', config.widthAdjustment ? '' : `width: ${config.width}px;`, config.paddingVertical, config.paddingHorizontal, config.paddingVertical, config.paddingHorizontal, this.props.config.backgroundMode === 'image' ? `background: url(${backgroundImage});\n                    background-size: cover;\n                    background-repeat: no-repeat;` : `background: ${this.props.config.backgroundColor || config.backgroundColor};\n                    background-size: auto;\n                    background-repeat: repeat;`, config.dropShadow ? `box-shadow: 0 ${config.dropShadowOffsetY} ${config.dropShadowBlurRadius} rgba(0, 0, 0, 0.55)` : '', config.lineNumbers ? 'padding-left: 12px;' : '', config.fontFamily, config.fontSize, config.lineHeight, COLORS.SECONDARY, this.props.readOnly ? 'hidden' : '']]]) + \" \" + \"bg\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 204,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(WidthHandler, {\n        innerRef: this.props.innerRef,\n        onChange: this.props.updateWidth,\n        paddingHorizontal: config.paddingHorizontal\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 207,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(_JSXStyle, {\n        id: \"3142620235\",\n        dynamic: [config.widthAdjustment ? '90px' : 'auto', config.widthAdjustment ? '1024px' : 'none', config.widthAdjustment ? '' : `width: ${config.width}px;`, config.paddingVertical, config.paddingHorizontal, config.paddingVertical, config.paddingHorizontal, this.props.config.backgroundMode === 'image' ? `background: url(${backgroundImage});\n                    background-size: cover;\n                    background-repeat: no-repeat;` : `background: ${this.props.config.backgroundColor || config.backgroundColor};\n                    background-size: auto;\n                    background-repeat: repeat;`, config.dropShadow ? `box-shadow: 0 ${config.dropShadowOffsetY} ${config.dropShadowBlurRadius} rgba(0, 0, 0, 0.55)` : '', config.lineNumbers ? 'padding-left: 12px;' : '', config.fontFamily, config.fontSize, config.lineHeight, COLORS.SECONDARY, this.props.readOnly ? 'hidden' : ''],\n        children: `.container.__jsx-style-dynamic-selector{position:relative;min-width:${config.widthAdjustment ? '90px' : 'auto'};max-width:${config.widthAdjustment ? '1024px' : 'none'};${config.widthAdjustment ? '' : `width: ${config.width}px;`} padding:${config.paddingVertical} ${config.paddingHorizontal};}.container.__jsx-style-dynamic-selector .watermark{fill-opacity:0.75;position:absolute;z-index:2;bottom:calc(${config.paddingVertical} + 16px);right:calc(${config.paddingHorizontal} + 16px);}.container.__jsx-style-dynamic-selector .container-bg.__jsx-style-dynamic-selector{position:absolute;top:0px;right:0px;bottom:0px;left:0px;}.container.__jsx-style-dynamic-selector .white.__jsx-style-dynamic-selector{background:#fff;position:absolute;top:0px;right:0px;bottom:0px;left:0px;}.container.__jsx-style-dynamic-selector .bg.__jsx-style-dynamic-selector{${this.props.config.backgroundMode === 'image' ? `background: url(${backgroundImage});\n                    background-size: cover;\n                    background-repeat: no-repeat;` : `background: ${this.props.config.backgroundColor || config.backgroundColor};\n                    background-size: auto;\n                    background-repeat: repeat;`} position:absolute;top:0px;right:0px;bottom:0px;left:0px;}.container.__jsx-style-dynamic-selector .alpha.__jsx-style-dynamic-selector{position:absolute;top:0px;right:0px;bottom:0px;left:0px;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAMUlEQVQ4T2NkYGAQYcAP3uCTZhw1gGGYhAGBZIA/nYDCgBDAm9BGDWAAJyRCgLaBCAAgXwixzAS0pgAAAABJRU5ErkJggg==);}.container.__jsx-style-dynamic-selector .CodeMirror-gutters{background-color:unset;border-right:none;}.container.__jsx-style-dynamic-selector .CodeMirror__container{min-width:inherit;position:relative;z-index:1;border-radius:5px;${config.dropShadow ? `box-shadow: 0 ${config.dropShadowOffsetY} ${config.dropShadowBlurRadius} rgba(0, 0, 0, 0.55)` : ''};}.container.__jsx-style-dynamic-selector .CodeMirror__container .CodeMirror{height:auto;min-width:inherit;padding:18px 18px;padding-left:12px;${config.lineNumbers ? 'padding-left: 12px;' : ''} border-radius:5px;font-family:${config.fontFamily},monospace !important;font-size:${config.fontSize};line-height:${config.lineHeight};font-variant-ligatures:contextual;font-feature-settings:'calt' 1;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;}.container.__jsx-style-dynamic-selector .CodeMirror-scroll,.container.__jsx-style-dynamic-selector .CodeMirror-hscrollbar{overflow:hidden !important;}.container.__jsx-style-dynamic-selector .window-theme__sharp > .CodeMirror{border-radius:0px;}.container.__jsx-style-dynamic-selector .window-theme__bw > .CodeMirror{border:2px solid ${COLORS.SECONDARY};}.container.__jsx-style-dynamic-selector .window-controls + .CodeMirror__container > .CodeMirror{padding-top:48px;}.container.__jsx-style-dynamic-selector .CodeMirror-linenumber{cursor:pointer;}.container.__jsx-style-dynamic-selector .CodeMirror-cursor{visibility:${this.props.readOnly ? 'hidden' : ''};}@media (max-width:768px){.container.__jsx-style-dynamic-selector [contenteditable='true']{-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text;}}\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9saW1lbmd5dS9EZXNrdG9wL3ByaXZhdGUvY29kZS9wcm9qZWN0L3Nob3ctY29kZXMvY29tcG9uZW50cy9DYXJib24uanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBb05XLEFBR2lDLEFBUUEsQUFRQSxBQVFGLEFBVUUsQUFRQSxBQVNLLEFBS0wsQUFRTixBQWVlLEFBSVQsQUFJNkIsQUFJOUIsQUFJRixBQUkwQixBQU10QixZQXhDRCxHQStCcEIsQ0F2RW9CLENBbUVwQixDQTNGeUMsQUFRckIsQUFRVixBQTBCQSxBQWNVLEFBMkJwQixLQWhDb0IsR0FsQ1IsQUEwQkEsQ0FvQ1osR0Fkb0IsSUF4Q1YsRUFoQkUsQUFTQyxBQTBCQSxBQWFELEtBTFosQUErQ0EsQ0F6RVksSUFoQnVDLEFBZ0QvQixDQXZDVCxBQWVELEFBV0MsQUEwQ1gsQ0FyQm9CLElBdkNQLEdBUUQsQ0FmWixBQTBCeUwsQ0E3Q2hKLE1BMkI5QixDQStCbUIsQ0F2QmpCLENBK0JvQyxNQXRDakQsSUFRVyxTQUNYLEFBbUVFLFFBN0NGLEVBakRrRCxDQVJrQixpQkFpRUYsOEJBeERsRSxpQ0F5RDBDLGVBakUxQyx5QkFrRTRDLHVCQXZCNUMsbUJBd0JvQyxrQ0FDSCwrQkFDZCxxRkFDbkIiLCJmaWxlIjoiL1VzZXJzL2xpbWVuZ3l1L0Rlc2t0b3AvcHJpdmF0ZS9jb2RlL3Byb2plY3Qvc2hvdy1jb2Rlcy9jb21wb25lbnRzL0NhcmJvbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCdcbmltcG9ydCBSZWFjdERPTSBmcm9tICdyZWFjdC1kb20nXG5pbXBvcnQgZHluYW1pYyBmcm9tICduZXh0L2R5bmFtaWMnXG5pbXBvcnQgaGxqcyBmcm9tICdoaWdobGlnaHQuanMvbGliL2NvcmUnXG5pbXBvcnQgamF2YXNjcmlwdCBmcm9tICdoaWdobGlnaHQuanMvbGliL2xhbmd1YWdlcy9qYXZhc2NyaXB0J1xuaW1wb3J0IGRlYm91bmNlIGZyb20gJ2xvZGFzaC5kZWJvdW5jZSdcbmltcG9ydCBtcyBmcm9tICdtcydcbmltcG9ydCB7IENvbnRyb2xsZWQgYXMgQ29kZU1pcnJvciB9IGZyb20gJ3JlYWN0LWNvZGVtaXJyb3IyJ1xuXG5obGpzLnJlZ2lzdGVyTGFuZ3VhZ2UoJ2phdmFzY3JpcHQnLCBqYXZhc2NyaXB0KVxuXG5pbXBvcnQgU3Bpbm5lcldyYXBwZXIgZnJvbSAnLi9TcGlubmVyV3JhcHBlcidcbmltcG9ydCBXaW5kb3dDb250cm9scyBmcm9tICcuL1dpbmRvd0NvbnRyb2xzJ1xuaW1wb3J0IFdpZHRoSGFuZGxlciBmcm9tICcuL1dpZHRoSGFuZGxlcidcblxuaW1wb3J0IHtcbiAgQ09MT1JTLFxuICBMQU5HVUFHRVMsXG4gIExBTkdVQUdFX01PREVfSEFTSCxcbiAgTEFOR1VBR0VfTkFNRV9IQVNILFxuICBMQU5HVUFHRV9NSU1FX0hBU0gsXG4gIERFRkFVTFRfU0VUVElOR1MsXG4gIFRIRU1FU19IQVNILFxufSBmcm9tICcuLi9saWIvY29uc3RhbnRzJ1xuXG5jb25zdCBTZWxlY3Rpb25FZGl0b3IgPSBkeW5hbWljKCgpID0+IGltcG9ydCgnLi9TZWxlY3Rpb25FZGl0b3InKSwge1xuICBsb2FkaW5nOiAoKSA9PiBudWxsLFxufSlcbmNvbnN0IFdhdGVybWFyayA9IGR5bmFtaWMoKCkgPT4gaW1wb3J0KCcuL3N2Zy9XYXRlcm1hcmsnKSwge1xuICBsb2FkaW5nOiAoKSA9PiBudWxsLFxufSlcblxuZnVuY3Rpb24gc2VhcmNoTGFuZ3VhZ2UobCkge1xuICByZXR1cm4gTEFOR1VBR0VfTkFNRV9IQVNIW2xdIHx8IExBTkdVQUdFX01PREVfSEFTSFtsXSB8fCBMQU5HVUFHRV9NSU1FX0hBU0hbbF1cbn1cblxuZnVuY3Rpb24gbm9vcCgpIHt9XG5mdW5jdGlvbiBnZXRVbmRlcmxpbmUodW5kZXJsaW5lKSB7XG4gIHN3aXRjaCAodW5kZXJsaW5lKSB7XG4gICAgY2FzZSAxOlxuICAgICAgcmV0dXJuICd1bmRlcmxpbmUnXG4gICAgY2FzZSAyOlxuICAgICAgLyoqXG4gICAgICAgKiBDaHJvbWUgd2lsbCBvbmx5IHJvdW5kIHRvIHRoZSBuZWFyZXN0IHdhdmUsIGNhdXNpbmcgdmlzdWFsIGluY29uc2lzdGVuY2llc1xuICAgICAgICogaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvNTc1NTk1ODgvaG93LXRvLW1ha2UtdGhlLXdhdnktdW5kZXJsaW5lLWV4dGVuZC1jb3Zlci1hbGwtdGhlLWNoYXJhY3RlcnMtaW4tY2hyb21lXG4gICAgICAgKi9cbiAgICAgIHJldHVybiBgJHtDT0xPUlMuUkVEfSB3YXZ5IHVuZGVybGluZTsgdGV4dC1kZWNvcmF0aW9uLXNraXAtaW5rOiBub25lYFxuICB9XG4gIHJldHVybiAnaW5pdGlhbCdcbn1cblxuY2xhc3MgQ2FyYm9uIGV4dGVuZHMgUmVhY3QuUHVyZUNvbXBvbmVudCB7XG4gIHN0YXRpYyBkZWZhdWx0UHJvcHMgPSB7XG4gICAgb25DaGFuZ2U6IG5vb3AsXG4gICAgb25HdXR0ZXJDbGljazogbm9vcCxcbiAgfVxuICBzdGF0ZSA9IHt9XG5cbiAgaGFuZGxlTGFuZ3VhZ2VDaGFuZ2UgPSBkZWJvdW5jZShcbiAgICAobmV3Q29kZSwgbGFuZ3VhZ2UpID0+IHtcbiAgICAgIGlmIChsYW5ndWFnZSA9PT0gJ2F1dG8nKSB7XG4gICAgICAgIC8vIHRyeSB0byBzZXQgdGhlIGxhbmd1YWdlXG4gICAgICAgIGNvbnN0IGRldGVjdGVkTGFuZ3VhZ2UgPSBobGpzLmhpZ2hsaWdodEF1dG8obmV3Q29kZSkubGFuZ3VhZ2VcbiAgICAgICAgY29uc3QgbGFuZ3VhZ2VNb2RlID0gc2VhcmNoTGFuZ3VhZ2UoZGV0ZWN0ZWRMYW5ndWFnZSlcblxuICAgICAgICBpZiAobGFuZ3VhZ2VNb2RlKSB7XG4gICAgICAgICAgcmV0dXJuIGxhbmd1YWdlTW9kZS5taW1lIHx8IGxhbmd1YWdlTW9kZS5tb2RlXG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgY29uc3QgbGFuZ3VhZ2VNb2RlID0gc2VhcmNoTGFuZ3VhZ2UobGFuZ3VhZ2UpXG5cbiAgICAgIGlmIChsYW5ndWFnZU1vZGUpIHtcbiAgICAgICAgcmV0dXJuIGxhbmd1YWdlTW9kZS5taW1lIHx8IGxhbmd1YWdlTW9kZS5tb2RlXG4gICAgICB9XG5cbiAgICAgIHJldHVybiBsYW5ndWFnZVxuICAgIH0sXG4gICAgbXMoJzMwMG1zJyksXG4gICAge1xuICAgICAgbGVhZGluZzogdHJ1ZSxcbiAgICAgIHRyYWlsaW5nOiB0cnVlLFxuICAgIH1cbiAgKVxuXG4gIG9uQmVmb3JlQ2hhbmdlID0gKGVkaXRvciwgbWV0YSwgY29kZSkgPT4ge1xuICAgIGlmICghdGhpcy5wcm9wcy5yZWFkT25seSkge1xuICAgICAgdGhpcy5wcm9wcy5vbkNoYW5nZShjb2RlKVxuICAgIH1cbiAgfVxuXG4gIG9uU2VsZWN0aW9uID0gKGVkLCBkYXRhKSA9PiB7XG4gICAgaWYgKHRoaXMucHJvcHMucmVhZE9ubHkpIHtcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIGNvbnN0IHNlbGVjdGlvbiA9IGRhdGEucmFuZ2VzWzBdXG4gICAgaWYgKFxuICAgICAgc2VsZWN0aW9uLmhlYWQubGluZSA9PT0gc2VsZWN0aW9uLmFuY2hvci5saW5lICYmXG4gICAgICBzZWxlY3Rpb24uaGVhZC5jaCA9PT0gc2VsZWN0aW9uLmFuY2hvci5jaFxuICAgICkge1xuICAgICAgcmV0dXJuICh0aGlzLmN1cnJlbnRTZWxlY3Rpb24gPSBudWxsKVxuICAgIH1cbiAgICBpZiAoc2VsZWN0aW9uLmhlYWQubGluZSArIHNlbGVjdGlvbi5oZWFkLmNoID4gc2VsZWN0aW9uLmFuY2hvci5saW5lICsgc2VsZWN0aW9uLmFuY2hvci5jaCkge1xuICAgICAgdGhpcy5jdXJyZW50U2VsZWN0aW9uID0ge1xuICAgICAgICBmcm9tOiBzZWxlY3Rpb24uYW5jaG9yLFxuICAgICAgICB0bzogc2VsZWN0aW9uLmhlYWQsXG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuY3VycmVudFNlbGVjdGlvbiA9IHtcbiAgICAgICAgZnJvbTogc2VsZWN0aW9uLmhlYWQsXG4gICAgICAgIHRvOiBzZWxlY3Rpb24uYW5jaG9yLFxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIG9uTW91c2VVcCA9ICgpID0+IHtcbiAgICBpZiAodGhpcy5jdXJyZW50U2VsZWN0aW9uKSB7XG4gICAgICB0aGlzLnNldFN0YXRlKHsgc2VsZWN0aW9uQXQ6IHRoaXMuY3VycmVudFNlbGVjdGlvbiB9LCAoKSA9PiB7XG4gICAgICAgIHRoaXMuY3VycmVudFNlbGVjdGlvbiA9IG51bGxcbiAgICAgIH0pXG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuc2V0U3RhdGUoeyBzZWxlY3Rpb25BdDogbnVsbCB9KVxuICAgIH1cbiAgfVxuXG4gIG9uU2VsZWN0aW9uQ2hhbmdlID0gY2hhbmdlcyA9PiB7XG4gICAgaWYgKHRoaXMuc3RhdGUuc2VsZWN0aW9uQXQpIHtcbiAgICAgIGNvbnN0IGNzcyA9IFtcbiAgICAgICAgY2hhbmdlcy5ib2xkICE9IG51bGwgJiYgYGZvbnQtd2VpZ2h0OiAke2NoYW5nZXMuYm9sZCA/ICdib2xkJyA6ICdpbml0aWFsJ31gLFxuICAgICAgICBjaGFuZ2VzLml0YWxpY3MgIT0gbnVsbCAmJiBgZm9udC1zdHlsZTogJHtjaGFuZ2VzLml0YWxpY3MgPyAnaXRhbGljJyA6ICdpbml0aWFsJ31gLFxuICAgICAgICBjaGFuZ2VzLnVuZGVybGluZSAhPSBudWxsICYmIGB0ZXh0LWRlY29yYXRpb246ICR7Z2V0VW5kZXJsaW5lKGNoYW5nZXMudW5kZXJsaW5lKX1gLFxuICAgICAgICBjaGFuZ2VzLmNvbG9yICE9IG51bGwgJiYgYGNvbG9yOiAke2NoYW5nZXMuY29sb3J9ICFpbXBvcnRhbnRgLFxuICAgICAgXVxuICAgICAgICAuZmlsdGVyKEJvb2xlYW4pXG4gICAgICAgIC5qb2luKCc7ICcpXG5cbiAgICAgIGlmIChjc3MpIHtcbiAgICAgICAgdGhpcy5wcm9wcy5lZGl0b3JSZWYuY3VycmVudC5lZGl0b3IuZG9jLm1hcmtUZXh0KFxuICAgICAgICAgIHRoaXMuc3RhdGUuc2VsZWN0aW9uQXQuZnJvbSxcbiAgICAgICAgICB0aGlzLnN0YXRlLnNlbGVjdGlvbkF0LnRvLFxuICAgICAgICAgIHsgY3NzIH1cbiAgICAgICAgKVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCBjb25maWcgPSB7IC4uLkRFRkFVTFRfU0VUVElOR1MsIC4uLnRoaXMucHJvcHMuY29uZmlnIH1cblxuICAgIGNvbnN0IGxhbmd1YWdlTW9kZSA9IHRoaXMuaGFuZGxlTGFuZ3VhZ2VDaGFuZ2UoXG4gICAgICB0aGlzLnByb3BzLmNoaWxkcmVuLFxuICAgICAgY29uZmlnLmxhbmd1YWdlICYmIGNvbmZpZy5sYW5ndWFnZS50b0xvd2VyQ2FzZSgpXG4gICAgKVxuXG4gICAgY29uc3Qgb3B0aW9ucyA9IHtcbiAgICAgIHNjcmVlblJlYWRlckxhYmVsOiAnQ29kZSBlZGl0b3InLFxuICAgICAgbGluZU51bWJlcnM6IGNvbmZpZy5saW5lTnVtYmVycyxcbiAgICAgIGZpcnN0TGluZU51bWJlcjogY29uZmlnLmZpcnN0TGluZU51bWJlcixcbiAgICAgIG1vZGU6IGxhbmd1YWdlTW9kZSB8fCAncGxhaW50ZXh0JyxcbiAgICAgIHRoZW1lOiBjb25maWcudGhlbWUsXG4gICAgICBzY3JvbGxiYXJTdHlsZTogbnVsbCxcbiAgICAgIHZpZXdwb3J0TWFyZ2luOiBJbmZpbml0eSxcbiAgICAgIGxpbmVXcmFwcGluZzogdHJ1ZSxcbiAgICAgIHNtYXJ0SW5kZW50OiB0cnVlLFxuICAgICAgZXh0cmFLZXlzOiB7XG4gICAgICAgICdTaGlmdC1UYWInOiAnaW5kZW50TGVzcycsXG4gICAgICB9LFxuICAgICAgcmVhZE9ubHk6IHRoaXMucHJvcHMucmVhZE9ubHksXG4gICAgICBzaG93SW52aXNpYmxlczogY29uZmlnLmhpZGRlbkNoYXJhY3RlcnMsXG4gICAgfVxuICAgIGNvbnN0IGJhY2tncm91bmRJbWFnZSA9XG4gICAgICAodGhpcy5wcm9wcy5jb25maWcuYmFja2dyb3VuZEltYWdlICYmIHRoaXMucHJvcHMuY29uZmlnLmJhY2tncm91bmRJbWFnZVNlbGVjdGlvbikgfHxcbiAgICAgIHRoaXMucHJvcHMuY29uZmlnLmJhY2tncm91bmRJbWFnZVxuXG4gICAgY29uc3QgdGhlbWVDb25maWcgPSB0aGlzLnByb3BzLnRoZW1lIHx8IFRIRU1FU19IQVNIW2NvbmZpZy50aGVtZV1cblxuICAgIGNvbnN0IGxpZ2h0ID0gdGhlbWVDb25maWcgJiYgdGhlbWVDb25maWcubGlnaHRcblxuICAgIC8qIGVzbGludC1kaXNhYmxlIGpzeC1hMTF5L25vLXN0YXRpYy1lbGVtZW50LWludGVyYWN0aW9ucyAqL1xuICAgIGNvbnN0IGNvbnRlbnQgPSAoXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImNvbnRhaW5lclwiPlxuICAgICAgICB7Y29uZmlnLndpbmRvd0NvbnRyb2xzID8gKFxuICAgICAgICAgIDxXaW5kb3dDb250cm9sc1xuICAgICAgICAgICAgdGhlbWU9e2NvbmZpZy53aW5kb3dUaGVtZX1cbiAgICAgICAgICAgIGNvZGU9e3RoaXMucHJvcHMuY2hpbGRyZW59XG4gICAgICAgICAgICBjb3B5YWJsZT17dGhpcy5wcm9wcy5jb3B5YWJsZX1cbiAgICAgICAgICAgIGxpZ2h0PXtsaWdodH1cbiAgICAgICAgICAvPlxuICAgICAgICApIDogbnVsbH1cbiAgICAgICAgPENvZGVNaXJyb3JcbiAgICAgICAgICByZWY9e3RoaXMucHJvcHMuZWRpdG9yUmVmfVxuICAgICAgICAgIGNsYXNzTmFtZT17YENvZGVNaXJyb3JfX2NvbnRhaW5lciB3aW5kb3ctdGhlbWVfXyR7Y29uZmlnLndpbmRvd1RoZW1lfWB9XG4gICAgICAgICAgdmFsdWU9e3RoaXMucHJvcHMuY2hpbGRyZW59XG4gICAgICAgICAgb3B0aW9ucz17b3B0aW9uc31cbiAgICAgICAgICBvbkJlZm9yZUNoYW5nZT17dGhpcy5vbkJlZm9yZUNoYW5nZX1cbiAgICAgICAgICBvbkd1dHRlckNsaWNrPXt0aGlzLnByb3BzLm9uR3V0dGVyQ2xpY2t9XG4gICAgICAgICAgb25TZWxlY3Rpb249e3RoaXMub25TZWxlY3Rpb259XG4gICAgICAgIC8+XG4gICAgICAgIHtjb25maWcud2F0ZXJtYXJrICYmIDxXYXRlcm1hcmsgbGlnaHQ9e2xpZ2h0fSAvPn1cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb250YWluZXItYmdcIj5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIndoaXRlIGVsaW1pbmF0ZU9uUmVuZGVyXCIgLz5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImFscGhhIGVsaW1pbmF0ZU9uUmVuZGVyXCIgLz5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImJnXCIgLz5cbiAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgPFdpZHRoSGFuZGxlclxuICAgICAgICAgIGlubmVyUmVmPXt0aGlzLnByb3BzLmlubmVyUmVmfVxuICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLnByb3BzLnVwZGF0ZVdpZHRofVxuICAgICAgICAgIHBhZGRpbmdIb3Jpem9udGFsPXtjb25maWcucGFkZGluZ0hvcml6b250YWx9XG4gICAgICAgIC8+XG4gICAgICAgIDxzdHlsZSBqc3g+XG4gICAgICAgICAge2BcbiAgICAgICAgICAgIC5jb250YWluZXIge1xuICAgICAgICAgICAgICBwb3NpdGlvbjogcmVsYXRpdmU7XG4gICAgICAgICAgICAgIG1pbi13aWR0aDogJHtjb25maWcud2lkdGhBZGp1c3RtZW50ID8gJzkwcHgnIDogJ2F1dG8nfTtcbiAgICAgICAgICAgICAgbWF4LXdpZHRoOiAke2NvbmZpZy53aWR0aEFkanVzdG1lbnQgPyAnMTAyNHB4JyA6ICdub25lJ307XG4gICAgICAgICAgICAgICR7Y29uZmlnLndpZHRoQWRqdXN0bWVudCA/ICcnIDogYHdpZHRoOiAke2NvbmZpZy53aWR0aH1weDtgfVxuICAgICAgICAgICAgICBwYWRkaW5nOiAke2NvbmZpZy5wYWRkaW5nVmVydGljYWx9ICR7Y29uZmlnLnBhZGRpbmdIb3Jpem9udGFsfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLmNvbnRhaW5lciA6Z2xvYmFsKC53YXRlcm1hcmspIHtcbiAgICAgICAgICAgICAgZmlsbC1vcGFjaXR5OiAwLjc1O1xuICAgICAgICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICAgICAgICAgIHotaW5kZXg6IDI7XG4gICAgICAgICAgICAgIGJvdHRvbTogY2FsYygke2NvbmZpZy5wYWRkaW5nVmVydGljYWx9ICsgMTZweCk7XG4gICAgICAgICAgICAgIHJpZ2h0OiBjYWxjKCR7Y29uZmlnLnBhZGRpbmdIb3Jpem9udGFsfSArIDE2cHgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAuY29udGFpbmVyIC5jb250YWluZXItYmcge1xuICAgICAgICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICAgICAgICAgIHRvcDogMHB4O1xuICAgICAgICAgICAgICByaWdodDogMHB4O1xuICAgICAgICAgICAgICBib3R0b206IDBweDtcbiAgICAgICAgICAgICAgbGVmdDogMHB4O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAuY29udGFpbmVyIC53aGl0ZSB7XG4gICAgICAgICAgICAgIGJhY2tncm91bmQ6ICNmZmY7XG4gICAgICAgICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICAgICAgICAgICAgdG9wOiAwcHg7XG4gICAgICAgICAgICAgIHJpZ2h0OiAwcHg7XG4gICAgICAgICAgICAgIGJvdHRvbTogMHB4O1xuICAgICAgICAgICAgICBsZWZ0OiAwcHg7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC5jb250YWluZXIgLmJnIHtcbiAgICAgICAgICAgICAgJHt0aGlzLnByb3BzLmNvbmZpZy5iYWNrZ3JvdW5kTW9kZSA9PT0gJ2ltYWdlJ1xuICAgICAgICAgICAgICAgID8gYGJhY2tncm91bmQ6IHVybCgke2JhY2tncm91bmRJbWFnZX0pO1xuICAgICAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kLXNpemU6IGNvdmVyO1xuICAgICAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kLXJlcGVhdDogbm8tcmVwZWF0O2BcbiAgICAgICAgICAgICAgICA6IGBiYWNrZ3JvdW5kOiAke3RoaXMucHJvcHMuY29uZmlnLmJhY2tncm91bmRDb2xvciB8fCBjb25maWcuYmFja2dyb3VuZENvbG9yfTtcbiAgICAgICAgICAgICAgICAgICAgYmFja2dyb3VuZC1zaXplOiBhdXRvO1xuICAgICAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kLXJlcGVhdDogcmVwZWF0O2B9XG4gICAgICAgICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICAgICAgICAgICAgdG9wOiAwcHg7XG4gICAgICAgICAgICAgIHJpZ2h0OiAwcHg7XG4gICAgICAgICAgICAgIGJvdHRvbTogMHB4O1xuICAgICAgICAgICAgICBsZWZ0OiAwcHg7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC5jb250YWluZXIgLmFscGhhIHtcbiAgICAgICAgICAgICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgICAgICAgICAgICB0b3A6IDBweDtcbiAgICAgICAgICAgICAgcmlnaHQ6IDBweDtcbiAgICAgICAgICAgICAgYm90dG9tOiAwcHg7XG4gICAgICAgICAgICAgIGxlZnQ6IDBweDtcbiAgICAgICAgICAgICAgYmFja2dyb3VuZDogdXJsKGRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBQkFBQUFBUUNBWUFBQUFmOC85aEFBQUFNVWxFUVZRNFQyTmtZR0FRWWNBUDN1Q1RaaHcxZ0dHWWhBR0JaSUEvbllEQ2dCREFtOUJHRFdBQUp5UkNnTGFCQ0FBZ1h3aXh6QVMwcGdBQUFBQkpSVTVFcmtKZ2dnPT0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAuY29udGFpbmVyIDpnbG9iYWwoLkNvZGVNaXJyb3ItZ3V0dGVycykge1xuICAgICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB1bnNldDtcbiAgICAgICAgICAgICAgYm9yZGVyLXJpZ2h0OiBub25lO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAuY29udGFpbmVyIDpnbG9iYWwoLkNvZGVNaXJyb3JfX2NvbnRhaW5lcikge1xuICAgICAgICAgICAgICBtaW4td2lkdGg6IGluaGVyaXQ7XG4gICAgICAgICAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgICAgICAgICAgICAgei1pbmRleDogMTtcbiAgICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogNXB4O1xuICAgICAgICAgICAgICAke2NvbmZpZy5kcm9wU2hhZG93XG4gICAgICAgICAgICAgICAgPyBgYm94LXNoYWRvdzogMCAke2NvbmZpZy5kcm9wU2hhZG93T2Zmc2V0WX0gJHtjb25maWcuZHJvcFNoYWRvd0JsdXJSYWRpdXN9IHJnYmEoMCwgMCwgMCwgMC41NSlgXG4gICAgICAgICAgICAgICAgOiAnJ307XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC5jb250YWluZXIgOmdsb2JhbCguQ29kZU1pcnJvcl9fY29udGFpbmVyIC5Db2RlTWlycm9yKSB7XG4gICAgICAgICAgICAgIGhlaWdodDogYXV0bztcbiAgICAgICAgICAgICAgbWluLXdpZHRoOiBpbmhlcml0O1xuICAgICAgICAgICAgICBwYWRkaW5nOiAxOHB4IDE4cHg7XG4gICAgICAgICAgICAgIHBhZGRpbmctbGVmdDogMTJweDtcbiAgICAgICAgICAgICAgJHtjb25maWcubGluZU51bWJlcnMgPyAncGFkZGluZy1sZWZ0OiAxMnB4OycgOiAnJ30gYm9yZGVyLXJhZGl1czogNXB4O1xuICAgICAgICAgICAgICBmb250LWZhbWlseTogJHtjb25maWcuZm9udEZhbWlseX0sIG1vbm9zcGFjZSAhaW1wb3J0YW50O1xuICAgICAgICAgICAgICBmb250LXNpemU6ICR7Y29uZmlnLmZvbnRTaXplfTtcbiAgICAgICAgICAgICAgbGluZS1oZWlnaHQ6ICR7Y29uZmlnLmxpbmVIZWlnaHR9O1xuICAgICAgICAgICAgICBmb250LXZhcmlhbnQtbGlnYXR1cmVzOiBjb250ZXh0dWFsO1xuICAgICAgICAgICAgICBmb250LWZlYXR1cmUtc2V0dGluZ3M6ICdjYWx0JyAxO1xuICAgICAgICAgICAgICB1c2VyLXNlbGVjdDogbm9uZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLmNvbnRhaW5lciA6Z2xvYmFsKC5Db2RlTWlycm9yLXNjcm9sbCksXG4gICAgICAgICAgICAuY29udGFpbmVyIDpnbG9iYWwoLkNvZGVNaXJyb3ItaHNjcm9sbGJhcikge1xuICAgICAgICAgICAgICBvdmVyZmxvdzogaGlkZGVuICFpbXBvcnRhbnQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC5jb250YWluZXIgOmdsb2JhbCgud2luZG93LXRoZW1lX19zaGFycCA+IC5Db2RlTWlycm9yKSB7XG4gICAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDBweDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLmNvbnRhaW5lciA6Z2xvYmFsKC53aW5kb3ctdGhlbWVfX2J3ID4gLkNvZGVNaXJyb3IpIHtcbiAgICAgICAgICAgICAgYm9yZGVyOiAycHggc29saWQgJHtDT0xPUlMuU0VDT05EQVJZfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLmNvbnRhaW5lciA6Z2xvYmFsKC53aW5kb3ctY29udHJvbHMgKyAuQ29kZU1pcnJvcl9fY29udGFpbmVyID4gLkNvZGVNaXJyb3IpIHtcbiAgICAgICAgICAgICAgcGFkZGluZy10b3A6IDQ4cHg7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC5jb250YWluZXIgOmdsb2JhbCguQ29kZU1pcnJvci1saW5lbnVtYmVyKSB7XG4gICAgICAgICAgICAgIGN1cnNvcjogcG9pbnRlcjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLmNvbnRhaW5lciA6Z2xvYmFsKC5Db2RlTWlycm9yLWN1cnNvcikge1xuICAgICAgICAgICAgICB2aXNpYmlsaXR5OiAke3RoaXMucHJvcHMucmVhZE9ubHkgPyAnaGlkZGVuJyA6ICcnfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgQG1lZGlhIChtYXgtd2lkdGg6IDc2OHB4KSB7XG4gICAgICAgICAgICAgIC8qIHNob3cgY3Vyc29yIG9uIG1vYmlsZSAqL1xuICAgICAgICAgICAgICAuY29udGFpbmVyIDpnbG9iYWwoW2NvbnRlbnRlZGl0YWJsZT0ndHJ1ZSddKSB7XG4gICAgICAgICAgICAgICAgdXNlci1zZWxlY3Q6IHRleHQ7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICBgfVxuICAgICAgICA8L3N0eWxlPlxuICAgICAgPC9kaXY+XG4gICAgKVxuXG4gICAgY29uc3Qgc2VsZWN0aW9uTm9kZSA9XG4gICAgICAhdGhpcy5wcm9wcy5yZWFkT25seSAmJlxuICAgICAgISF0aGlzLnN0YXRlLnNlbGVjdGlvbkF0ICYmXG4gICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3R5bGUtZWRpdG9yLWJ1dHRvbicpXG5cbiAgICByZXR1cm4gKFxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJzZWN0aW9uXCI+XG4gICAgICAgIDxkaXZcbiAgICAgICAgICByZWY9e3RoaXMucHJvcHMuaW5uZXJSZWZ9XG4gICAgICAgICAgaWQ9XCJleHBvcnQtY29udGFpbmVyXCJcbiAgICAgICAgICBjbGFzc05hbWU9XCJleHBvcnQtY29udGFpbmVyXCJcbiAgICAgICAgICBvbk1vdXNlVXA9e3RoaXMub25Nb3VzZVVwfVxuICAgICAgICA+XG4gICAgICAgICAgPFNwaW5uZXJXcmFwcGVyIGxvYWRpbmc9e3RoaXMucHJvcHMubG9hZGluZ30+e2NvbnRlbnR9PC9TcGlubmVyV3JhcHBlcj5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIHtzZWxlY3Rpb25Ob2RlICYmXG4gICAgICAgICAgUmVhY3RET00uY3JlYXRlUG9ydGFsKFxuICAgICAgICAgICAgPFNlbGVjdGlvbkVkaXRvciBvbkNoYW5nZT17dGhpcy5vblNlbGVjdGlvbkNoYW5nZX0gLz4sXG4gICAgICAgICAgICAvLyBUT0RPOiBkb24ndCB1c2UgcG9ydGFsP1xuICAgICAgICAgICAgc2VsZWN0aW9uTm9kZVxuICAgICAgICAgICl9XG4gICAgICAgIDxzdHlsZSBqc3g+XG4gICAgICAgICAge2BcbiAgICAgICAgICAgIC5zZWN0aW9uLFxuICAgICAgICAgICAgLmV4cG9ydC1jb250YWluZXIge1xuICAgICAgICAgICAgICBoZWlnaHQ6IDEwMCU7XG4gICAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgICAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG4gICAgICAgICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuICAgICAgICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgICAgICAgICAgICBvdmVyZmxvdzogaGlkZGVuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIGB9XG4gICAgICAgIDwvc3R5bGU+XG4gICAgICA8L2Rpdj5cbiAgICApXG4gIH1cbn1cblxubGV0IG1vZGVzTG9hZGVkID0gZmFsc2VcbmZ1bmN0aW9uIHVzZU1vZGVMb2FkZXIoKSB7XG4gIFJlYWN0LnVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKCFtb2Rlc0xvYWRlZCkge1xuICAgICAgTEFOR1VBR0VTLmZpbHRlcihcbiAgICAgICAgbGFuZ3VhZ2UgPT4gbGFuZ3VhZ2UubW9kZSAmJiBsYW5ndWFnZS5tb2RlICE9PSAnYXV0bycgJiYgbGFuZ3VhZ2UubW9kZSAhPT0gJ3RleHQnXG4gICAgICApLmZvckVhY2gobGFuZ3VhZ2UgPT4ge1xuICAgICAgICBsYW5ndWFnZS5jdXN0b21cbiAgICAgICAgICA/IHJlcXVpcmUoYC4uL2xpYi9jdXN0b20vbW9kZXMvJHtsYW5ndWFnZS5tb2RlfWApXG4gICAgICAgICAgOiByZXF1aXJlKGBjb2RlbWlycm9yL21vZGUvJHtsYW5ndWFnZS5tb2RlfS8ke2xhbmd1YWdlLm1vZGV9YClcbiAgICAgIH0pXG4gICAgICBtb2Rlc0xvYWRlZCA9IHRydWVcbiAgICB9XG4gIH0sIFtdKVxufVxuXG5sZXQgaGlnaExpZ2h0c0xvYWRlZCA9IGZhbHNlXG5mdW5jdGlvbiB1c2VIaWdobGlnaHRMb2FkZXIoKSB7XG4gIFJlYWN0LnVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKCFoaWdoTGlnaHRzTG9hZGVkKSB7XG4gICAgICBpbXBvcnQoJy4uL2xpYi9oaWdobGlnaHQtbGFuZ3VhZ2VzJylcbiAgICAgICAgLnRoZW4ocmVzID0+IHJlcy5kZWZhdWx0Lm1hcChjb25maWcgPT4gaGxqcy5yZWdpc3Rlckxhbmd1YWdlKGNvbmZpZ1swXSwgY29uZmlnWzFdKSkpXG4gICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICBoaWdoTGlnaHRzTG9hZGVkID0gdHJ1ZVxuICAgICAgICB9KVxuICAgIH1cbiAgfSwgW10pXG59XG5cbmZ1bmN0aW9uIHNlbGVjdGVkTGluZXNSZWR1Y2VyKFxuICB7IHByZXZMaW5lLCBzZWxlY3RlZCB9LFxuICB7IHR5cGUsIGxpbmVOdW1iZXIsIG51bUxpbmVzLCBzZWxlY3RlZExpbmVzIH1cbikge1xuICBjb25zdCBuZXdTdGF0ZSA9IHt9XG5cbiAgc3dpdGNoICh0eXBlKSB7XG4gICAgY2FzZSAnR1JPVVAnOiB7XG4gICAgICBpZiAocHJldkxpbmUpIHtcbiAgICAgICAgZm9yIChsZXQgaSA9IE1hdGgubWluKHByZXZMaW5lLCBsaW5lTnVtYmVyKTsgaSA8IE1hdGgubWF4KHByZXZMaW5lLCBsaW5lTnVtYmVyKSArIDE7IGkrKykge1xuICAgICAgICAgIG5ld1N0YXRlW2ldID0gc2VsZWN0ZWRbcHJldkxpbmVdXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGJyZWFrXG4gICAgfVxuICAgIGNhc2UgJ01VTFRJTElORSc6IHtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2VsZWN0ZWRMaW5lcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBuZXdTdGF0ZVtzZWxlY3RlZExpbmVzW2ldIC0gMV0gPSB0cnVlXG4gICAgICB9XG4gICAgICBicmVha1xuICAgIH1cbiAgICBkZWZhdWx0OiB7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG51bUxpbmVzOyBpKyspIHtcbiAgICAgICAgaWYgKGkgIT0gbGluZU51bWJlcikge1xuICAgICAgICAgIGlmIChwcmV2TGluZSA9PSBudWxsKSB7XG4gICAgICAgICAgICBuZXdTdGF0ZVtpXSA9IGZhbHNlXG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG5ld1N0YXRlW2xpbmVOdW1iZXJdID0gc2VsZWN0ZWRbbGluZU51bWJlcl0gPT09IHRydWUgPyBmYWxzZSA6IHRydWVcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiB7XG4gICAgc2VsZWN0ZWQ6IHsgLi4uc2VsZWN0ZWQsIC4uLm5ld1N0YXRlIH0sXG4gICAgcHJldkxpbmU6IGxpbmVOdW1iZXIsXG4gIH1cbn1cblxuZnVuY3Rpb24gdXNlU2VsZWN0ZWRMaW5lcyhwcm9wcywgZWRpdG9yUmVmKSB7XG4gIGNvbnN0IFtzdGF0ZSwgZGlzcGF0Y2hdID0gUmVhY3QudXNlUmVkdWNlcihzZWxlY3RlZExpbmVzUmVkdWNlciwge1xuICAgIHByZXZMaW5lOiBudWxsLFxuICAgIHNlbGVjdGVkOiB7fSxcbiAgfSlcblxuICBSZWFjdC51c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChlZGl0b3JSZWYuY3VycmVudCAmJiBPYmplY3Qua2V5cyhzdGF0ZS5zZWxlY3RlZCkubGVuZ3RoID4gMCkge1xuICAgICAgZWRpdG9yUmVmLmN1cnJlbnQuZWRpdG9yLmRpc3BsYXkudmlldy5mb3JFYWNoKChsaW5lLCBpKSA9PiB7XG4gICAgICAgIGlmIChsaW5lLnRleHQpIHtcbiAgICAgICAgICBsaW5lLnRleHQuc3R5bGUub3BhY2l0eSA9IHN0YXRlLnNlbGVjdGVkW2ldID09PSB0cnVlID8gMSA6IDAuNVxuICAgICAgICB9XG4gICAgICAgIGlmIChsaW5lLmd1dHRlcikge1xuICAgICAgICAgIGxpbmUuZ3V0dGVyLnN0eWxlLm9wYWNpdHkgPSBzdGF0ZS5zZWxlY3RlZFtpXSA9PT0gdHJ1ZSA/IDEgOiAwLjVcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICB9XG4gIH0sIFtzdGF0ZS5zZWxlY3RlZCwgcHJvcHMuY2hpbGRyZW4sIHByb3BzLmNvbmZpZywgZWRpdG9yUmVmXSlcblxuICBSZWFjdC51c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChwcm9wcy5jb25maWcuc2VsZWN0ZWRMaW5lcykge1xuICAgICAgZGlzcGF0Y2goe1xuICAgICAgICB0eXBlOiAnTVVMVElMSU5FJyxcbiAgICAgICAgc2VsZWN0ZWRMaW5lczogcHJvcHMuY29uZmlnLnNlbGVjdGVkTGluZXMsXG4gICAgICB9KVxuICAgIH1cbiAgfSwgW3Byb3BzLmNvbmZpZy5zZWxlY3RlZExpbmVzXSlcblxuICByZXR1cm4gUmVhY3QudXNlQ2FsbGJhY2soZnVuY3Rpb24gb25HdXR0ZXJDbGljayhlZGl0b3IsIGxpbmVOdW1iZXIsIGd1dHRlciwgZSkge1xuICAgIGNvbnN0IG51bUxpbmVzID0gZWRpdG9yLmRpc3BsYXkudmlldy5sZW5ndGhcbiAgICBjb25zdCB0eXBlID0gZS5zaGlmdEtleSA/ICdHUk9VUCcgOiAnTElORSdcbiAgICBkaXNwYXRjaCh7IHR5cGUsIGxpbmVOdW1iZXIsIG51bUxpbmVzIH0pXG4gIH0sIFtdKVxufVxuXG5mdW5jdGlvbiB1c2VTaG93SW52aXNpYmxlc0xvYWRlcigpIHtcbiAgUmVhY3QudXNlRWZmZWN0KCgpID0+IHZvaWQgcmVxdWlyZSgnY20tc2hvdy1pbnZpc2libGVzJyksIFtdKVxufVxuXG5mdW5jdGlvbiBDYXJib25Db250YWluZXIocHJvcHMsIHJlZikge1xuICB1c2VNb2RlTG9hZGVyKClcbiAgdXNlSGlnaGxpZ2h0TG9hZGVyKClcbiAgdXNlU2hvd0ludmlzaWJsZXNMb2FkZXIoKVxuICBjb25zdCBlZGl0b3JSZWYgPSBSZWFjdC5jcmVhdGVSZWYoKVxuICBjb25zdCBvbkd1dHRlckNsaWNrID0gdXNlU2VsZWN0ZWRMaW5lcyhwcm9wcywgZWRpdG9yUmVmKVxuXG4gIHJldHVybiA8Q2FyYm9uIHsuLi5wcm9wc30gaW5uZXJSZWY9e3JlZn0gZWRpdG9yUmVmPXtlZGl0b3JSZWZ9IG9uR3V0dGVyQ2xpY2s9e29uR3V0dGVyQ2xpY2t9IC8+XG59XG5cbmV4cG9ydCBkZWZhdWx0IFJlYWN0LmZvcndhcmRSZWYoQ2FyYm9uQ29udGFpbmVyKVxuIl19 */\n/*@ sourceURL=/Users/limengyu/Desktop/private/code/project/show-codes/components/Carbon.js */`\n      }, void 0, false, void 0, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 7\n    }, this);\n\n    const selectionNode = !this.props.readOnly && !!this.state.selectionAt && document.getElementById('style-editor-button');\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"jsx-621676041\" + \" \" + \"section\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        ref: this.props.innerRef,\n        id: \"export-container\",\n        onMouseUp: this.onMouseUp,\n        className: \"jsx-621676041\" + \" \" + \"export-container\",\n        children: /*#__PURE__*/_jsxDEV(SpinnerWrapper, {\n          loading: this.props.loading,\n          children: content\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 349,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 343,\n        columnNumber: 9\n      }, this), selectionNode && /*#__PURE__*/ReactDOM.createPortal( /*#__PURE__*/_jsxDEV(SelectionEditor, {\n        onChange: this.onSelectionChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 353,\n        columnNumber: 13\n      }, this), // TODO: don't use portal?\n      selectionNode), /*#__PURE__*/_jsxDEV(_JSXStyle, {\n        id: \"621676041\",\n        children: \".section.jsx-621676041,.export-container.jsx-621676041{height:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;overflow:hidden;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9saW1lbmd5dS9EZXNrdG9wL3ByaXZhdGUvY29kZS9wcm9qZWN0L3Nob3ctY29kZXMvY29tcG9uZW50cy9DYXJib24uanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBcVdXLEFBSTJCLFlBQ0MsMEVBQ1MsOEVBQ0MsbUdBQ0osNkZBQ0gsZ0JBQ2xCIiwiZmlsZSI6Ii9Vc2Vycy9saW1lbmd5dS9EZXNrdG9wL3ByaXZhdGUvY29kZS9wcm9qZWN0L3Nob3ctY29kZXMvY29tcG9uZW50cy9DYXJib24uanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnXG5pbXBvcnQgUmVhY3RET00gZnJvbSAncmVhY3QtZG9tJ1xuaW1wb3J0IGR5bmFtaWMgZnJvbSAnbmV4dC9keW5hbWljJ1xuaW1wb3J0IGhsanMgZnJvbSAnaGlnaGxpZ2h0LmpzL2xpYi9jb3JlJ1xuaW1wb3J0IGphdmFzY3JpcHQgZnJvbSAnaGlnaGxpZ2h0LmpzL2xpYi9sYW5ndWFnZXMvamF2YXNjcmlwdCdcbmltcG9ydCBkZWJvdW5jZSBmcm9tICdsb2Rhc2guZGVib3VuY2UnXG5pbXBvcnQgbXMgZnJvbSAnbXMnXG5pbXBvcnQgeyBDb250cm9sbGVkIGFzIENvZGVNaXJyb3IgfSBmcm9tICdyZWFjdC1jb2RlbWlycm9yMidcblxuaGxqcy5yZWdpc3Rlckxhbmd1YWdlKCdqYXZhc2NyaXB0JywgamF2YXNjcmlwdClcblxuaW1wb3J0IFNwaW5uZXJXcmFwcGVyIGZyb20gJy4vU3Bpbm5lcldyYXBwZXInXG5pbXBvcnQgV2luZG93Q29udHJvbHMgZnJvbSAnLi9XaW5kb3dDb250cm9scydcbmltcG9ydCBXaWR0aEhhbmRsZXIgZnJvbSAnLi9XaWR0aEhhbmRsZXInXG5cbmltcG9ydCB7XG4gIENPTE9SUyxcbiAgTEFOR1VBR0VTLFxuICBMQU5HVUFHRV9NT0RFX0hBU0gsXG4gIExBTkdVQUdFX05BTUVfSEFTSCxcbiAgTEFOR1VBR0VfTUlNRV9IQVNILFxuICBERUZBVUxUX1NFVFRJTkdTLFxuICBUSEVNRVNfSEFTSCxcbn0gZnJvbSAnLi4vbGliL2NvbnN0YW50cydcblxuY29uc3QgU2VsZWN0aW9uRWRpdG9yID0gZHluYW1pYygoKSA9PiBpbXBvcnQoJy4vU2VsZWN0aW9uRWRpdG9yJyksIHtcbiAgbG9hZGluZzogKCkgPT4gbnVsbCxcbn0pXG5jb25zdCBXYXRlcm1hcmsgPSBkeW5hbWljKCgpID0+IGltcG9ydCgnLi9zdmcvV2F0ZXJtYXJrJyksIHtcbiAgbG9hZGluZzogKCkgPT4gbnVsbCxcbn0pXG5cbmZ1bmN0aW9uIHNlYXJjaExhbmd1YWdlKGwpIHtcbiAgcmV0dXJuIExBTkdVQUdFX05BTUVfSEFTSFtsXSB8fCBMQU5HVUFHRV9NT0RFX0hBU0hbbF0gfHwgTEFOR1VBR0VfTUlNRV9IQVNIW2xdXG59XG5cbmZ1bmN0aW9uIG5vb3AoKSB7fVxuZnVuY3Rpb24gZ2V0VW5kZXJsaW5lKHVuZGVybGluZSkge1xuICBzd2l0Y2ggKHVuZGVybGluZSkge1xuICAgIGNhc2UgMTpcbiAgICAgIHJldHVybiAndW5kZXJsaW5lJ1xuICAgIGNhc2UgMjpcbiAgICAgIC8qKlxuICAgICAgICogQ2hyb21lIHdpbGwgb25seSByb3VuZCB0byB0aGUgbmVhcmVzdCB3YXZlLCBjYXVzaW5nIHZpc3VhbCBpbmNvbnNpc3RlbmNpZXNcbiAgICAgICAqIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzU3NTU5NTg4L2hvdy10by1tYWtlLXRoZS13YXZ5LXVuZGVybGluZS1leHRlbmQtY292ZXItYWxsLXRoZS1jaGFyYWN0ZXJzLWluLWNocm9tZVxuICAgICAgICovXG4gICAgICByZXR1cm4gYCR7Q09MT1JTLlJFRH0gd2F2eSB1bmRlcmxpbmU7IHRleHQtZGVjb3JhdGlvbi1za2lwLWluazogbm9uZWBcbiAgfVxuICByZXR1cm4gJ2luaXRpYWwnXG59XG5cbmNsYXNzIENhcmJvbiBleHRlbmRzIFJlYWN0LlB1cmVDb21wb25lbnQge1xuICBzdGF0aWMgZGVmYXVsdFByb3BzID0ge1xuICAgIG9uQ2hhbmdlOiBub29wLFxuICAgIG9uR3V0dGVyQ2xpY2s6IG5vb3AsXG4gIH1cbiAgc3RhdGUgPSB7fVxuXG4gIGhhbmRsZUxhbmd1YWdlQ2hhbmdlID0gZGVib3VuY2UoXG4gICAgKG5ld0NvZGUsIGxhbmd1YWdlKSA9PiB7XG4gICAgICBpZiAobGFuZ3VhZ2UgPT09ICdhdXRvJykge1xuICAgICAgICAvLyB0cnkgdG8gc2V0IHRoZSBsYW5ndWFnZVxuICAgICAgICBjb25zdCBkZXRlY3RlZExhbmd1YWdlID0gaGxqcy5oaWdobGlnaHRBdXRvKG5ld0NvZGUpLmxhbmd1YWdlXG4gICAgICAgIGNvbnN0IGxhbmd1YWdlTW9kZSA9IHNlYXJjaExhbmd1YWdlKGRldGVjdGVkTGFuZ3VhZ2UpXG5cbiAgICAgICAgaWYgKGxhbmd1YWdlTW9kZSkge1xuICAgICAgICAgIHJldHVybiBsYW5ndWFnZU1vZGUubWltZSB8fCBsYW5ndWFnZU1vZGUubW9kZVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGxhbmd1YWdlTW9kZSA9IHNlYXJjaExhbmd1YWdlKGxhbmd1YWdlKVxuXG4gICAgICBpZiAobGFuZ3VhZ2VNb2RlKSB7XG4gICAgICAgIHJldHVybiBsYW5ndWFnZU1vZGUubWltZSB8fCBsYW5ndWFnZU1vZGUubW9kZVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gbGFuZ3VhZ2VcbiAgICB9LFxuICAgIG1zKCczMDBtcycpLFxuICAgIHtcbiAgICAgIGxlYWRpbmc6IHRydWUsXG4gICAgICB0cmFpbGluZzogdHJ1ZSxcbiAgICB9XG4gIClcblxuICBvbkJlZm9yZUNoYW5nZSA9IChlZGl0b3IsIG1ldGEsIGNvZGUpID0+IHtcbiAgICBpZiAoIXRoaXMucHJvcHMucmVhZE9ubHkpIHtcbiAgICAgIHRoaXMucHJvcHMub25DaGFuZ2UoY29kZSlcbiAgICB9XG4gIH1cblxuICBvblNlbGVjdGlvbiA9IChlZCwgZGF0YSkgPT4ge1xuICAgIGlmICh0aGlzLnByb3BzLnJlYWRPbmx5KSB7XG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICBjb25zdCBzZWxlY3Rpb24gPSBkYXRhLnJhbmdlc1swXVxuICAgIGlmIChcbiAgICAgIHNlbGVjdGlvbi5oZWFkLmxpbmUgPT09IHNlbGVjdGlvbi5hbmNob3IubGluZSAmJlxuICAgICAgc2VsZWN0aW9uLmhlYWQuY2ggPT09IHNlbGVjdGlvbi5hbmNob3IuY2hcbiAgICApIHtcbiAgICAgIHJldHVybiAodGhpcy5jdXJyZW50U2VsZWN0aW9uID0gbnVsbClcbiAgICB9XG4gICAgaWYgKHNlbGVjdGlvbi5oZWFkLmxpbmUgKyBzZWxlY3Rpb24uaGVhZC5jaCA+IHNlbGVjdGlvbi5hbmNob3IubGluZSArIHNlbGVjdGlvbi5hbmNob3IuY2gpIHtcbiAgICAgIHRoaXMuY3VycmVudFNlbGVjdGlvbiA9IHtcbiAgICAgICAgZnJvbTogc2VsZWN0aW9uLmFuY2hvcixcbiAgICAgICAgdG86IHNlbGVjdGlvbi5oZWFkLFxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmN1cnJlbnRTZWxlY3Rpb24gPSB7XG4gICAgICAgIGZyb206IHNlbGVjdGlvbi5oZWFkLFxuICAgICAgICB0bzogc2VsZWN0aW9uLmFuY2hvcixcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBvbk1vdXNlVXAgPSAoKSA9PiB7XG4gICAgaWYgKHRoaXMuY3VycmVudFNlbGVjdGlvbikge1xuICAgICAgdGhpcy5zZXRTdGF0ZSh7IHNlbGVjdGlvbkF0OiB0aGlzLmN1cnJlbnRTZWxlY3Rpb24gfSwgKCkgPT4ge1xuICAgICAgICB0aGlzLmN1cnJlbnRTZWxlY3Rpb24gPSBudWxsXG4gICAgICB9KVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnNldFN0YXRlKHsgc2VsZWN0aW9uQXQ6IG51bGwgfSlcbiAgICB9XG4gIH1cblxuICBvblNlbGVjdGlvbkNoYW5nZSA9IGNoYW5nZXMgPT4ge1xuICAgIGlmICh0aGlzLnN0YXRlLnNlbGVjdGlvbkF0KSB7XG4gICAgICBjb25zdCBjc3MgPSBbXG4gICAgICAgIGNoYW5nZXMuYm9sZCAhPSBudWxsICYmIGBmb250LXdlaWdodDogJHtjaGFuZ2VzLmJvbGQgPyAnYm9sZCcgOiAnaW5pdGlhbCd9YCxcbiAgICAgICAgY2hhbmdlcy5pdGFsaWNzICE9IG51bGwgJiYgYGZvbnQtc3R5bGU6ICR7Y2hhbmdlcy5pdGFsaWNzID8gJ2l0YWxpYycgOiAnaW5pdGlhbCd9YCxcbiAgICAgICAgY2hhbmdlcy51bmRlcmxpbmUgIT0gbnVsbCAmJiBgdGV4dC1kZWNvcmF0aW9uOiAke2dldFVuZGVybGluZShjaGFuZ2VzLnVuZGVybGluZSl9YCxcbiAgICAgICAgY2hhbmdlcy5jb2xvciAhPSBudWxsICYmIGBjb2xvcjogJHtjaGFuZ2VzLmNvbG9yfSAhaW1wb3J0YW50YCxcbiAgICAgIF1cbiAgICAgICAgLmZpbHRlcihCb29sZWFuKVxuICAgICAgICAuam9pbignOyAnKVxuXG4gICAgICBpZiAoY3NzKSB7XG4gICAgICAgIHRoaXMucHJvcHMuZWRpdG9yUmVmLmN1cnJlbnQuZWRpdG9yLmRvYy5tYXJrVGV4dChcbiAgICAgICAgICB0aGlzLnN0YXRlLnNlbGVjdGlvbkF0LmZyb20sXG4gICAgICAgICAgdGhpcy5zdGF0ZS5zZWxlY3Rpb25BdC50byxcbiAgICAgICAgICB7IGNzcyB9XG4gICAgICAgIClcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgY29uc3QgY29uZmlnID0geyAuLi5ERUZBVUxUX1NFVFRJTkdTLCAuLi50aGlzLnByb3BzLmNvbmZpZyB9XG5cbiAgICBjb25zdCBsYW5ndWFnZU1vZGUgPSB0aGlzLmhhbmRsZUxhbmd1YWdlQ2hhbmdlKFxuICAgICAgdGhpcy5wcm9wcy5jaGlsZHJlbixcbiAgICAgIGNvbmZpZy5sYW5ndWFnZSAmJiBjb25maWcubGFuZ3VhZ2UudG9Mb3dlckNhc2UoKVxuICAgIClcblxuICAgIGNvbnN0IG9wdGlvbnMgPSB7XG4gICAgICBzY3JlZW5SZWFkZXJMYWJlbDogJ0NvZGUgZWRpdG9yJyxcbiAgICAgIGxpbmVOdW1iZXJzOiBjb25maWcubGluZU51bWJlcnMsXG4gICAgICBmaXJzdExpbmVOdW1iZXI6IGNvbmZpZy5maXJzdExpbmVOdW1iZXIsXG4gICAgICBtb2RlOiBsYW5ndWFnZU1vZGUgfHwgJ3BsYWludGV4dCcsXG4gICAgICB0aGVtZTogY29uZmlnLnRoZW1lLFxuICAgICAgc2Nyb2xsYmFyU3R5bGU6IG51bGwsXG4gICAgICB2aWV3cG9ydE1hcmdpbjogSW5maW5pdHksXG4gICAgICBsaW5lV3JhcHBpbmc6IHRydWUsXG4gICAgICBzbWFydEluZGVudDogdHJ1ZSxcbiAgICAgIGV4dHJhS2V5czoge1xuICAgICAgICAnU2hpZnQtVGFiJzogJ2luZGVudExlc3MnLFxuICAgICAgfSxcbiAgICAgIHJlYWRPbmx5OiB0aGlzLnByb3BzLnJlYWRPbmx5LFxuICAgICAgc2hvd0ludmlzaWJsZXM6IGNvbmZpZy5oaWRkZW5DaGFyYWN0ZXJzLFxuICAgIH1cbiAgICBjb25zdCBiYWNrZ3JvdW5kSW1hZ2UgPVxuICAgICAgKHRoaXMucHJvcHMuY29uZmlnLmJhY2tncm91bmRJbWFnZSAmJiB0aGlzLnByb3BzLmNvbmZpZy5iYWNrZ3JvdW5kSW1hZ2VTZWxlY3Rpb24pIHx8XG4gICAgICB0aGlzLnByb3BzLmNvbmZpZy5iYWNrZ3JvdW5kSW1hZ2VcblxuICAgIGNvbnN0IHRoZW1lQ29uZmlnID0gdGhpcy5wcm9wcy50aGVtZSB8fCBUSEVNRVNfSEFTSFtjb25maWcudGhlbWVdXG5cbiAgICBjb25zdCBsaWdodCA9IHRoZW1lQ29uZmlnICYmIHRoZW1lQ29uZmlnLmxpZ2h0XG5cbiAgICAvKiBlc2xpbnQtZGlzYWJsZSBqc3gtYTExeS9uby1zdGF0aWMtZWxlbWVudC1pbnRlcmFjdGlvbnMgKi9cbiAgICBjb25zdCBjb250ZW50ID0gKFxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb250YWluZXJcIj5cbiAgICAgICAge2NvbmZpZy53aW5kb3dDb250cm9scyA/IChcbiAgICAgICAgICA8V2luZG93Q29udHJvbHNcbiAgICAgICAgICAgIHRoZW1lPXtjb25maWcud2luZG93VGhlbWV9XG4gICAgICAgICAgICBjb2RlPXt0aGlzLnByb3BzLmNoaWxkcmVufVxuICAgICAgICAgICAgY29weWFibGU9e3RoaXMucHJvcHMuY29weWFibGV9XG4gICAgICAgICAgICBsaWdodD17bGlnaHR9XG4gICAgICAgICAgLz5cbiAgICAgICAgKSA6IG51bGx9XG4gICAgICAgIDxDb2RlTWlycm9yXG4gICAgICAgICAgcmVmPXt0aGlzLnByb3BzLmVkaXRvclJlZn1cbiAgICAgICAgICBjbGFzc05hbWU9e2BDb2RlTWlycm9yX19jb250YWluZXIgd2luZG93LXRoZW1lX18ke2NvbmZpZy53aW5kb3dUaGVtZX1gfVxuICAgICAgICAgIHZhbHVlPXt0aGlzLnByb3BzLmNoaWxkcmVufVxuICAgICAgICAgIG9wdGlvbnM9e29wdGlvbnN9XG4gICAgICAgICAgb25CZWZvcmVDaGFuZ2U9e3RoaXMub25CZWZvcmVDaGFuZ2V9XG4gICAgICAgICAgb25HdXR0ZXJDbGljaz17dGhpcy5wcm9wcy5vbkd1dHRlckNsaWNrfVxuICAgICAgICAgIG9uU2VsZWN0aW9uPXt0aGlzLm9uU2VsZWN0aW9ufVxuICAgICAgICAvPlxuICAgICAgICB7Y29uZmlnLndhdGVybWFyayAmJiA8V2F0ZXJtYXJrIGxpZ2h0PXtsaWdodH0gLz59XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY29udGFpbmVyLWJnXCI+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ3aGl0ZSBlbGltaW5hdGVPblJlbmRlclwiIC8+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJhbHBoYSBlbGltaW5hdGVPblJlbmRlclwiIC8+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJiZ1wiIC8+XG4gICAgICAgIDwvZGl2PlxuXG4gICAgICAgIDxXaWR0aEhhbmRsZXJcbiAgICAgICAgICBpbm5lclJlZj17dGhpcy5wcm9wcy5pbm5lclJlZn1cbiAgICAgICAgICBvbkNoYW5nZT17dGhpcy5wcm9wcy51cGRhdGVXaWR0aH1cbiAgICAgICAgICBwYWRkaW5nSG9yaXpvbnRhbD17Y29uZmlnLnBhZGRpbmdIb3Jpem9udGFsfVxuICAgICAgICAvPlxuICAgICAgICA8c3R5bGUganN4PlxuICAgICAgICAgIHtgXG4gICAgICAgICAgICAuY29udGFpbmVyIHtcbiAgICAgICAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlO1xuICAgICAgICAgICAgICBtaW4td2lkdGg6ICR7Y29uZmlnLndpZHRoQWRqdXN0bWVudCA/ICc5MHB4JyA6ICdhdXRvJ307XG4gICAgICAgICAgICAgIG1heC13aWR0aDogJHtjb25maWcud2lkdGhBZGp1c3RtZW50ID8gJzEwMjRweCcgOiAnbm9uZSd9O1xuICAgICAgICAgICAgICAke2NvbmZpZy53aWR0aEFkanVzdG1lbnQgPyAnJyA6IGB3aWR0aDogJHtjb25maWcud2lkdGh9cHg7YH1cbiAgICAgICAgICAgICAgcGFkZGluZzogJHtjb25maWcucGFkZGluZ1ZlcnRpY2FsfSAke2NvbmZpZy5wYWRkaW5nSG9yaXpvbnRhbH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC5jb250YWluZXIgOmdsb2JhbCgud2F0ZXJtYXJrKSB7XG4gICAgICAgICAgICAgIGZpbGwtb3BhY2l0eTogMC43NTtcbiAgICAgICAgICAgICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgICAgICAgICAgICB6LWluZGV4OiAyO1xuICAgICAgICAgICAgICBib3R0b206IGNhbGMoJHtjb25maWcucGFkZGluZ1ZlcnRpY2FsfSArIDE2cHgpO1xuICAgICAgICAgICAgICByaWdodDogY2FsYygke2NvbmZpZy5wYWRkaW5nSG9yaXpvbnRhbH0gKyAxNnB4KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLmNvbnRhaW5lciAuY29udGFpbmVyLWJnIHtcbiAgICAgICAgICAgICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgICAgICAgICAgICB0b3A6IDBweDtcbiAgICAgICAgICAgICAgcmlnaHQ6IDBweDtcbiAgICAgICAgICAgICAgYm90dG9tOiAwcHg7XG4gICAgICAgICAgICAgIGxlZnQ6IDBweDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLmNvbnRhaW5lciAud2hpdGUge1xuICAgICAgICAgICAgICBiYWNrZ3JvdW5kOiAjZmZmO1xuICAgICAgICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICAgICAgICAgIHRvcDogMHB4O1xuICAgICAgICAgICAgICByaWdodDogMHB4O1xuICAgICAgICAgICAgICBib3R0b206IDBweDtcbiAgICAgICAgICAgICAgbGVmdDogMHB4O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAuY29udGFpbmVyIC5iZyB7XG4gICAgICAgICAgICAgICR7dGhpcy5wcm9wcy5jb25maWcuYmFja2dyb3VuZE1vZGUgPT09ICdpbWFnZSdcbiAgICAgICAgICAgICAgICA/IGBiYWNrZ3JvdW5kOiB1cmwoJHtiYWNrZ3JvdW5kSW1hZ2V9KTtcbiAgICAgICAgICAgICAgICAgICAgYmFja2dyb3VuZC1zaXplOiBjb3ZlcjtcbiAgICAgICAgICAgICAgICAgICAgYmFja2dyb3VuZC1yZXBlYXQ6IG5vLXJlcGVhdDtgXG4gICAgICAgICAgICAgICAgOiBgYmFja2dyb3VuZDogJHt0aGlzLnByb3BzLmNvbmZpZy5iYWNrZ3JvdW5kQ29sb3IgfHwgY29uZmlnLmJhY2tncm91bmRDb2xvcn07XG4gICAgICAgICAgICAgICAgICAgIGJhY2tncm91bmQtc2l6ZTogYXV0bztcbiAgICAgICAgICAgICAgICAgICAgYmFja2dyb3VuZC1yZXBlYXQ6IHJlcGVhdDtgfVxuICAgICAgICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICAgICAgICAgIHRvcDogMHB4O1xuICAgICAgICAgICAgICByaWdodDogMHB4O1xuICAgICAgICAgICAgICBib3R0b206IDBweDtcbiAgICAgICAgICAgICAgbGVmdDogMHB4O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAuY29udGFpbmVyIC5hbHBoYSB7XG4gICAgICAgICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICAgICAgICAgICAgdG9wOiAwcHg7XG4gICAgICAgICAgICAgIHJpZ2h0OiAwcHg7XG4gICAgICAgICAgICAgIGJvdHRvbTogMHB4O1xuICAgICAgICAgICAgICBsZWZ0OiAwcHg7XG4gICAgICAgICAgICAgIGJhY2tncm91bmQ6IHVybChkYXRhOmltYWdlL3BuZztiYXNlNjQsaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQUJBQUFBQVFDQVlBQUFBZjgvOWhBQUFBTVVsRVFWUTRUMk5rWUdBUVljQVAzdUNUWmh3MWdHR1loQUdCWklBL25ZRENnQkRBbTlCR0RXQUFKeVJDZ0xhQkNBQWdYd2l4ekFTMHBnQUFBQUJKUlU1RXJrSmdnZz09KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLmNvbnRhaW5lciA6Z2xvYmFsKC5Db2RlTWlycm9yLWd1dHRlcnMpIHtcbiAgICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogdW5zZXQ7XG4gICAgICAgICAgICAgIGJvcmRlci1yaWdodDogbm9uZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLmNvbnRhaW5lciA6Z2xvYmFsKC5Db2RlTWlycm9yX19jb250YWluZXIpIHtcbiAgICAgICAgICAgICAgbWluLXdpZHRoOiBpbmhlcml0O1xuICAgICAgICAgICAgICBwb3NpdGlvbjogcmVsYXRpdmU7XG4gICAgICAgICAgICAgIHotaW5kZXg6IDE7XG4gICAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDVweDtcbiAgICAgICAgICAgICAgJHtjb25maWcuZHJvcFNoYWRvd1xuICAgICAgICAgICAgICAgID8gYGJveC1zaGFkb3c6IDAgJHtjb25maWcuZHJvcFNoYWRvd09mZnNldFl9ICR7Y29uZmlnLmRyb3BTaGFkb3dCbHVyUmFkaXVzfSByZ2JhKDAsIDAsIDAsIDAuNTUpYFxuICAgICAgICAgICAgICAgIDogJyd9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAuY29udGFpbmVyIDpnbG9iYWwoLkNvZGVNaXJyb3JfX2NvbnRhaW5lciAuQ29kZU1pcnJvcikge1xuICAgICAgICAgICAgICBoZWlnaHQ6IGF1dG87XG4gICAgICAgICAgICAgIG1pbi13aWR0aDogaW5oZXJpdDtcbiAgICAgICAgICAgICAgcGFkZGluZzogMThweCAxOHB4O1xuICAgICAgICAgICAgICBwYWRkaW5nLWxlZnQ6IDEycHg7XG4gICAgICAgICAgICAgICR7Y29uZmlnLmxpbmVOdW1iZXJzID8gJ3BhZGRpbmctbGVmdDogMTJweDsnIDogJyd9IGJvcmRlci1yYWRpdXM6IDVweDtcbiAgICAgICAgICAgICAgZm9udC1mYW1pbHk6ICR7Y29uZmlnLmZvbnRGYW1pbHl9LCBtb25vc3BhY2UgIWltcG9ydGFudDtcbiAgICAgICAgICAgICAgZm9udC1zaXplOiAke2NvbmZpZy5mb250U2l6ZX07XG4gICAgICAgICAgICAgIGxpbmUtaGVpZ2h0OiAke2NvbmZpZy5saW5lSGVpZ2h0fTtcbiAgICAgICAgICAgICAgZm9udC12YXJpYW50LWxpZ2F0dXJlczogY29udGV4dHVhbDtcbiAgICAgICAgICAgICAgZm9udC1mZWF0dXJlLXNldHRpbmdzOiAnY2FsdCcgMTtcbiAgICAgICAgICAgICAgdXNlci1zZWxlY3Q6IG5vbmU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC5jb250YWluZXIgOmdsb2JhbCguQ29kZU1pcnJvci1zY3JvbGwpLFxuICAgICAgICAgICAgLmNvbnRhaW5lciA6Z2xvYmFsKC5Db2RlTWlycm9yLWhzY3JvbGxiYXIpIHtcbiAgICAgICAgICAgICAgb3ZlcmZsb3c6IGhpZGRlbiAhaW1wb3J0YW50O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAuY29udGFpbmVyIDpnbG9iYWwoLndpbmRvdy10aGVtZV9fc2hhcnAgPiAuQ29kZU1pcnJvcikge1xuICAgICAgICAgICAgICBib3JkZXItcmFkaXVzOiAwcHg7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC5jb250YWluZXIgOmdsb2JhbCgud2luZG93LXRoZW1lX19idyA+IC5Db2RlTWlycm9yKSB7XG4gICAgICAgICAgICAgIGJvcmRlcjogMnB4IHNvbGlkICR7Q09MT1JTLlNFQ09OREFSWX07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC5jb250YWluZXIgOmdsb2JhbCgud2luZG93LWNvbnRyb2xzICsgLkNvZGVNaXJyb3JfX2NvbnRhaW5lciA+IC5Db2RlTWlycm9yKSB7XG4gICAgICAgICAgICAgIHBhZGRpbmctdG9wOiA0OHB4O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAuY29udGFpbmVyIDpnbG9iYWwoLkNvZGVNaXJyb3ItbGluZW51bWJlcikge1xuICAgICAgICAgICAgICBjdXJzb3I6IHBvaW50ZXI7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC5jb250YWluZXIgOmdsb2JhbCguQ29kZU1pcnJvci1jdXJzb3IpIHtcbiAgICAgICAgICAgICAgdmlzaWJpbGl0eTogJHt0aGlzLnByb3BzLnJlYWRPbmx5ID8gJ2hpZGRlbicgOiAnJ307XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIEBtZWRpYSAobWF4LXdpZHRoOiA3NjhweCkge1xuICAgICAgICAgICAgICAvKiBzaG93IGN1cnNvciBvbiBtb2JpbGUgKi9cbiAgICAgICAgICAgICAgLmNvbnRhaW5lciA6Z2xvYmFsKFtjb250ZW50ZWRpdGFibGU9J3RydWUnXSkge1xuICAgICAgICAgICAgICAgIHVzZXItc2VsZWN0OiB0ZXh0O1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgYH1cbiAgICAgICAgPC9zdHlsZT5cbiAgICAgIDwvZGl2PlxuICAgIClcblxuICAgIGNvbnN0IHNlbGVjdGlvbk5vZGUgPVxuICAgICAgIXRoaXMucHJvcHMucmVhZE9ubHkgJiZcbiAgICAgICEhdGhpcy5zdGF0ZS5zZWxlY3Rpb25BdCAmJlxuICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N0eWxlLWVkaXRvci1idXR0b24nKVxuXG4gICAgcmV0dXJuIChcbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwic2VjdGlvblwiPlxuICAgICAgICA8ZGl2XG4gICAgICAgICAgcmVmPXt0aGlzLnByb3BzLmlubmVyUmVmfVxuICAgICAgICAgIGlkPVwiZXhwb3J0LWNvbnRhaW5lclwiXG4gICAgICAgICAgY2xhc3NOYW1lPVwiZXhwb3J0LWNvbnRhaW5lclwiXG4gICAgICAgICAgb25Nb3VzZVVwPXt0aGlzLm9uTW91c2VVcH1cbiAgICAgICAgPlxuICAgICAgICAgIDxTcGlubmVyV3JhcHBlciBsb2FkaW5nPXt0aGlzLnByb3BzLmxvYWRpbmd9Pntjb250ZW50fTwvU3Bpbm5lcldyYXBwZXI+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICB7c2VsZWN0aW9uTm9kZSAmJlxuICAgICAgICAgIFJlYWN0RE9NLmNyZWF0ZVBvcnRhbChcbiAgICAgICAgICAgIDxTZWxlY3Rpb25FZGl0b3Igb25DaGFuZ2U9e3RoaXMub25TZWxlY3Rpb25DaGFuZ2V9IC8+LFxuICAgICAgICAgICAgLy8gVE9ETzogZG9uJ3QgdXNlIHBvcnRhbD9cbiAgICAgICAgICAgIHNlbGVjdGlvbk5vZGVcbiAgICAgICAgICApfVxuICAgICAgICA8c3R5bGUganN4PlxuICAgICAgICAgIHtgXG4gICAgICAgICAgICAuc2VjdGlvbixcbiAgICAgICAgICAgIC5leHBvcnQtY29udGFpbmVyIHtcbiAgICAgICAgICAgICAgaGVpZ2h0OiAxMDAlO1xuICAgICAgICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICAgICAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcbiAgICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgICAgICAgICAgb3ZlcmZsb3c6IGhpZGRlbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICBgfVxuICAgICAgICA8L3N0eWxlPlxuICAgICAgPC9kaXY+XG4gICAgKVxuICB9XG59XG5cbmxldCBtb2Rlc0xvYWRlZCA9IGZhbHNlXG5mdW5jdGlvbiB1c2VNb2RlTG9hZGVyKCkge1xuICBSZWFjdC51c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmICghbW9kZXNMb2FkZWQpIHtcbiAgICAgIExBTkdVQUdFUy5maWx0ZXIoXG4gICAgICAgIGxhbmd1YWdlID0+IGxhbmd1YWdlLm1vZGUgJiYgbGFuZ3VhZ2UubW9kZSAhPT0gJ2F1dG8nICYmIGxhbmd1YWdlLm1vZGUgIT09ICd0ZXh0J1xuICAgICAgKS5mb3JFYWNoKGxhbmd1YWdlID0+IHtcbiAgICAgICAgbGFuZ3VhZ2UuY3VzdG9tXG4gICAgICAgICAgPyByZXF1aXJlKGAuLi9saWIvY3VzdG9tL21vZGVzLyR7bGFuZ3VhZ2UubW9kZX1gKVxuICAgICAgICAgIDogcmVxdWlyZShgY29kZW1pcnJvci9tb2RlLyR7bGFuZ3VhZ2UubW9kZX0vJHtsYW5ndWFnZS5tb2RlfWApXG4gICAgICB9KVxuICAgICAgbW9kZXNMb2FkZWQgPSB0cnVlXG4gICAgfVxuICB9LCBbXSlcbn1cblxubGV0IGhpZ2hMaWdodHNMb2FkZWQgPSBmYWxzZVxuZnVuY3Rpb24gdXNlSGlnaGxpZ2h0TG9hZGVyKCkge1xuICBSZWFjdC51c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmICghaGlnaExpZ2h0c0xvYWRlZCkge1xuICAgICAgaW1wb3J0KCcuLi9saWIvaGlnaGxpZ2h0LWxhbmd1YWdlcycpXG4gICAgICAgIC50aGVuKHJlcyA9PiByZXMuZGVmYXVsdC5tYXAoY29uZmlnID0+IGhsanMucmVnaXN0ZXJMYW5ndWFnZShjb25maWdbMF0sIGNvbmZpZ1sxXSkpKVxuICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgaGlnaExpZ2h0c0xvYWRlZCA9IHRydWVcbiAgICAgICAgfSlcbiAgICB9XG4gIH0sIFtdKVxufVxuXG5mdW5jdGlvbiBzZWxlY3RlZExpbmVzUmVkdWNlcihcbiAgeyBwcmV2TGluZSwgc2VsZWN0ZWQgfSxcbiAgeyB0eXBlLCBsaW5lTnVtYmVyLCBudW1MaW5lcywgc2VsZWN0ZWRMaW5lcyB9XG4pIHtcbiAgY29uc3QgbmV3U3RhdGUgPSB7fVxuXG4gIHN3aXRjaCAodHlwZSkge1xuICAgIGNhc2UgJ0dST1VQJzoge1xuICAgICAgaWYgKHByZXZMaW5lKSB7XG4gICAgICAgIGZvciAobGV0IGkgPSBNYXRoLm1pbihwcmV2TGluZSwgbGluZU51bWJlcik7IGkgPCBNYXRoLm1heChwcmV2TGluZSwgbGluZU51bWJlcikgKyAxOyBpKyspIHtcbiAgICAgICAgICBuZXdTdGF0ZVtpXSA9IHNlbGVjdGVkW3ByZXZMaW5lXVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBicmVha1xuICAgIH1cbiAgICBjYXNlICdNVUxUSUxJTkUnOiB7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNlbGVjdGVkTGluZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgbmV3U3RhdGVbc2VsZWN0ZWRMaW5lc1tpXSAtIDFdID0gdHJ1ZVxuICAgICAgfVxuICAgICAgYnJlYWtcbiAgICB9XG4gICAgZGVmYXVsdDoge1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1MaW5lczsgaSsrKSB7XG4gICAgICAgIGlmIChpICE9IGxpbmVOdW1iZXIpIHtcbiAgICAgICAgICBpZiAocHJldkxpbmUgPT0gbnVsbCkge1xuICAgICAgICAgICAgbmV3U3RhdGVbaV0gPSBmYWxzZVxuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBuZXdTdGF0ZVtsaW5lTnVtYmVyXSA9IHNlbGVjdGVkW2xpbmVOdW1iZXJdID09PSB0cnVlID8gZmFsc2UgOiB0cnVlXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4ge1xuICAgIHNlbGVjdGVkOiB7IC4uLnNlbGVjdGVkLCAuLi5uZXdTdGF0ZSB9LFxuICAgIHByZXZMaW5lOiBsaW5lTnVtYmVyLFxuICB9XG59XG5cbmZ1bmN0aW9uIHVzZVNlbGVjdGVkTGluZXMocHJvcHMsIGVkaXRvclJlZikge1xuICBjb25zdCBbc3RhdGUsIGRpc3BhdGNoXSA9IFJlYWN0LnVzZVJlZHVjZXIoc2VsZWN0ZWRMaW5lc1JlZHVjZXIsIHtcbiAgICBwcmV2TGluZTogbnVsbCxcbiAgICBzZWxlY3RlZDoge30sXG4gIH0pXG5cbiAgUmVhY3QudXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAoZWRpdG9yUmVmLmN1cnJlbnQgJiYgT2JqZWN0LmtleXMoc3RhdGUuc2VsZWN0ZWQpLmxlbmd0aCA+IDApIHtcbiAgICAgIGVkaXRvclJlZi5jdXJyZW50LmVkaXRvci5kaXNwbGF5LnZpZXcuZm9yRWFjaCgobGluZSwgaSkgPT4ge1xuICAgICAgICBpZiAobGluZS50ZXh0KSB7XG4gICAgICAgICAgbGluZS50ZXh0LnN0eWxlLm9wYWNpdHkgPSBzdGF0ZS5zZWxlY3RlZFtpXSA9PT0gdHJ1ZSA/IDEgOiAwLjVcbiAgICAgICAgfVxuICAgICAgICBpZiAobGluZS5ndXR0ZXIpIHtcbiAgICAgICAgICBsaW5lLmd1dHRlci5zdHlsZS5vcGFjaXR5ID0gc3RhdGUuc2VsZWN0ZWRbaV0gPT09IHRydWUgPyAxIDogMC41XG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgfVxuICB9LCBbc3RhdGUuc2VsZWN0ZWQsIHByb3BzLmNoaWxkcmVuLCBwcm9wcy5jb25maWcsIGVkaXRvclJlZl0pXG5cbiAgUmVhY3QudXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAocHJvcHMuY29uZmlnLnNlbGVjdGVkTGluZXMpIHtcbiAgICAgIGRpc3BhdGNoKHtcbiAgICAgICAgdHlwZTogJ01VTFRJTElORScsXG4gICAgICAgIHNlbGVjdGVkTGluZXM6IHByb3BzLmNvbmZpZy5zZWxlY3RlZExpbmVzLFxuICAgICAgfSlcbiAgICB9XG4gIH0sIFtwcm9wcy5jb25maWcuc2VsZWN0ZWRMaW5lc10pXG5cbiAgcmV0dXJuIFJlYWN0LnVzZUNhbGxiYWNrKGZ1bmN0aW9uIG9uR3V0dGVyQ2xpY2soZWRpdG9yLCBsaW5lTnVtYmVyLCBndXR0ZXIsIGUpIHtcbiAgICBjb25zdCBudW1MaW5lcyA9IGVkaXRvci5kaXNwbGF5LnZpZXcubGVuZ3RoXG4gICAgY29uc3QgdHlwZSA9IGUuc2hpZnRLZXkgPyAnR1JPVVAnIDogJ0xJTkUnXG4gICAgZGlzcGF0Y2goeyB0eXBlLCBsaW5lTnVtYmVyLCBudW1MaW5lcyB9KVxuICB9LCBbXSlcbn1cblxuZnVuY3Rpb24gdXNlU2hvd0ludmlzaWJsZXNMb2FkZXIoKSB7XG4gIFJlYWN0LnVzZUVmZmVjdCgoKSA9PiB2b2lkIHJlcXVpcmUoJ2NtLXNob3ctaW52aXNpYmxlcycpLCBbXSlcbn1cblxuZnVuY3Rpb24gQ2FyYm9uQ29udGFpbmVyKHByb3BzLCByZWYpIHtcbiAgdXNlTW9kZUxvYWRlcigpXG4gIHVzZUhpZ2hsaWdodExvYWRlcigpXG4gIHVzZVNob3dJbnZpc2libGVzTG9hZGVyKClcbiAgY29uc3QgZWRpdG9yUmVmID0gUmVhY3QuY3JlYXRlUmVmKClcbiAgY29uc3Qgb25HdXR0ZXJDbGljayA9IHVzZVNlbGVjdGVkTGluZXMocHJvcHMsIGVkaXRvclJlZilcblxuICByZXR1cm4gPENhcmJvbiB7Li4ucHJvcHN9IGlubmVyUmVmPXtyZWZ9IGVkaXRvclJlZj17ZWRpdG9yUmVmfSBvbkd1dHRlckNsaWNrPXtvbkd1dHRlckNsaWNrfSAvPlxufVxuXG5leHBvcnQgZGVmYXVsdCBSZWFjdC5mb3J3YXJkUmVmKENhcmJvbkNvbnRhaW5lcilcbiJdfQ== */\\n/*@ sourceURL=/Users/limengyu/Desktop/private/code/project/show-codes/components/Carbon.js */\"\n      }, void 0, false, void 0, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 342,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\n_defineProperty(Carbon, \"defaultProps\", {\n  onChange: noop,\n  onGutterClick: noop\n});\n\nlet modesLoaded = false;\n\nfunction useModeLoader() {\n  React.useEffect(() => {\n    if (!modesLoaded) {\n      LANGUAGES.filter(language => language.mode && language.mode !== 'auto' && language.mode !== 'text').forEach(language => {\n        language.custom ? require(`../lib/custom/modes/${language.mode}`) : require(`codemirror/mode/${language.mode}/${language.mode}`);\n      });\n      modesLoaded = true;\n    }\n  }, []);\n}\n\nlet highLightsLoaded = false;\n\nfunction useHighlightLoader() {\n  React.useEffect(() => {\n    if (!highLightsLoaded) {\n      import('../lib/highlight-languages').then(res => res.default.map(config => hljs.registerLanguage(config[0], config[1]))).then(() => {\n        highLightsLoaded = true;\n      });\n    }\n  }, []);\n}\n\nfunction selectedLinesReducer({\n  prevLine,\n  selected\n}, {\n  type,\n  lineNumber,\n  numLines,\n  selectedLines\n}) {\n  const newState = {};\n\n  switch (type) {\n    case 'GROUP':\n      {\n        if (prevLine) {\n          for (let i = Math.min(prevLine, lineNumber); i < Math.max(prevLine, lineNumber) + 1; i++) {\n            newState[i] = selected[prevLine];\n          }\n        }\n\n        break;\n      }\n\n    case 'MULTILINE':\n      {\n        for (let i = 0; i < selectedLines.length; i++) {\n          newState[selectedLines[i] - 1] = true;\n        }\n\n        break;\n      }\n\n    default:\n      {\n        for (let i = 0; i < numLines; i++) {\n          if (i != lineNumber) {\n            if (prevLine == null) {\n              newState[i] = false;\n            }\n          } else {\n            newState[lineNumber] = selected[lineNumber] === true ? false : true;\n          }\n        }\n      }\n  }\n\n  return {\n    selected: _objectSpread(_objectSpread({}, selected), newState),\n    prevLine: lineNumber\n  };\n}\n\nfunction useSelectedLines(props, editorRef) {\n  const [state, dispatch] = React.useReducer(selectedLinesReducer, {\n    prevLine: null,\n    selected: {}\n  });\n  React.useEffect(() => {\n    if (editorRef.current && Object.keys(state.selected).length > 0) {\n      editorRef.current.editor.display.view.forEach((line, i) => {\n        if (line.text) {\n          line.text.style.opacity = state.selected[i] === true ? 1 : 0.5;\n        }\n\n        if (line.gutter) {\n          line.gutter.style.opacity = state.selected[i] === true ? 1 : 0.5;\n        }\n      });\n    }\n  }, [state.selected, props.children, props.config, editorRef]);\n  React.useEffect(() => {\n    if (props.config.selectedLines) {\n      dispatch({\n        type: 'MULTILINE',\n        selectedLines: props.config.selectedLines\n      });\n    }\n  }, [props.config.selectedLines]);\n  return React.useCallback(function onGutterClick(editor, lineNumber, gutter, e) {\n    const numLines = editor.display.view.length;\n    const type = e.shiftKey ? 'GROUP' : 'LINE';\n    dispatch({\n      type,\n      lineNumber,\n      numLines\n    });\n  }, []);\n}\n\nfunction useShowInvisiblesLoader() {\n  React.useEffect(() => void require('cm-show-invisibles'), []);\n}\n\nfunction CarbonContainer(props, ref) {\n  useModeLoader();\n  useHighlightLoader();\n  useShowInvisiblesLoader();\n  const editorRef = /*#__PURE__*/React.createRef();\n  const onGutterClick = useSelectedLines(props, editorRef);\n  return /*#__PURE__*/_jsxDEV(Carbon, _objectSpread(_objectSpread({}, props), {}, {\n    innerRef: ref,\n    editorRef: editorRef,\n    onGutterClick: onGutterClick\n  }), void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 490,\n    columnNumber: 10\n  }, this);\n}\n\nexport default /*#__PURE__*/React.forwardRef(CarbonContainer);","map":{"version":3,"sources":["/Users/limengyu/Desktop/private/code/project/show-codes/components/Carbon.js"],"names":["React","ReactDOM","dynamic","hljs","javascript","debounce","ms","Controlled","CodeMirror","registerLanguage","SpinnerWrapper","WindowControls","WidthHandler","COLORS","LANGUAGES","LANGUAGE_MODE_HASH","LANGUAGE_NAME_HASH","LANGUAGE_MIME_HASH","DEFAULT_SETTINGS","THEMES_HASH","SelectionEditor","loading","Watermark","searchLanguage","l","noop","getUnderline","underline","RED","Carbon","PureComponent","newCode","language","detectedLanguage","highlightAuto","languageMode","mime","mode","leading","trailing","editor","meta","code","props","readOnly","onChange","ed","data","selection","ranges","head","line","anchor","ch","currentSelection","from","to","setState","selectionAt","changes","state","css","bold","italics","color","filter","Boolean","join","editorRef","current","doc","markText","render","config","handleLanguageChange","children","toLowerCase","options","screenReaderLabel","lineNumbers","firstLineNumber","theme","scrollbarStyle","viewportMargin","Infinity","lineWrapping","smartIndent","extraKeys","showInvisibles","hiddenCharacters","backgroundImage","backgroundImageSelection","themeConfig","light","content","widthAdjustment","width","paddingVertical","paddingHorizontal","backgroundMode","backgroundColor","dropShadow","dropShadowOffsetY","dropShadowBlurRadius","fontFamily","fontSize","lineHeight","SECONDARY","windowControls","windowTheme","copyable","onBeforeChange","onGutterClick","onSelection","watermark","innerRef","updateWidth","selectionNode","document","getElementById","onMouseUp","createPortal","onSelectionChange","modesLoaded","useModeLoader","useEffect","forEach","custom","require","highLightsLoaded","useHighlightLoader","then","res","default","map","selectedLinesReducer","prevLine","selected","type","lineNumber","numLines","selectedLines","newState","i","Math","min","max","length","useSelectedLines","dispatch","useReducer","Object","keys","display","view","text","style","opacity","gutter","useCallback","e","shiftKey","useShowInvisiblesLoader","CarbonContainer","ref","createRef","forwardRef"],"mappings":"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","sourcesContent":["import React from 'react'\nimport ReactDOM from 'react-dom'\nimport dynamic from 'next/dynamic'\nimport hljs from 'highlight.js/lib/core'\nimport javascript from 'highlight.js/lib/languages/javascript'\nimport debounce from 'lodash.debounce'\nimport ms from 'ms'\nimport { Controlled as CodeMirror } from 'react-codemirror2'\n\nhljs.registerLanguage('javascript', javascript)\n\nimport SpinnerWrapper from './SpinnerWrapper'\nimport WindowControls from './WindowControls'\nimport WidthHandler from './WidthHandler'\n\nimport {\n  COLORS,\n  LANGUAGES,\n  LANGUAGE_MODE_HASH,\n  LANGUAGE_NAME_HASH,\n  LANGUAGE_MIME_HASH,\n  DEFAULT_SETTINGS,\n  THEMES_HASH,\n} from '../lib/constants'\n\nconst SelectionEditor = dynamic(() => import('./SelectionEditor'), {\n  loading: () => null,\n})\nconst Watermark = dynamic(() => import('./svg/Watermark'), {\n  loading: () => null,\n})\n\nfunction searchLanguage(l) {\n  return LANGUAGE_NAME_HASH[l] || LANGUAGE_MODE_HASH[l] || LANGUAGE_MIME_HASH[l]\n}\n\nfunction noop() {}\nfunction getUnderline(underline) {\n  switch (underline) {\n    case 1:\n      return 'underline'\n    case 2:\n      /**\n       * Chrome will only round to the nearest wave, causing visual inconsistencies\n       * https://stackoverflow.com/questions/57559588/how-to-make-the-wavy-underline-extend-cover-all-the-characters-in-chrome\n       */\n      return `${COLORS.RED} wavy underline; text-decoration-skip-ink: none`\n  }\n  return 'initial'\n}\n\nclass Carbon extends React.PureComponent {\n  static defaultProps = {\n    onChange: noop,\n    onGutterClick: noop,\n  }\n  state = {}\n\n  handleLanguageChange = debounce(\n    (newCode, language) => {\n      if (language === 'auto') {\n        // try to set the language\n        const detectedLanguage = hljs.highlightAuto(newCode).language\n        const languageMode = searchLanguage(detectedLanguage)\n\n        if (languageMode) {\n          return languageMode.mime || languageMode.mode\n        }\n      }\n\n      const languageMode = searchLanguage(language)\n\n      if (languageMode) {\n        return languageMode.mime || languageMode.mode\n      }\n\n      return language\n    },\n    ms('300ms'),\n    {\n      leading: true,\n      trailing: true,\n    }\n  )\n\n  onBeforeChange = (editor, meta, code) => {\n    if (!this.props.readOnly) {\n      this.props.onChange(code)\n    }\n  }\n\n  onSelection = (ed, data) => {\n    if (this.props.readOnly) {\n      return\n    }\n\n    const selection = data.ranges[0]\n    if (\n      selection.head.line === selection.anchor.line &&\n      selection.head.ch === selection.anchor.ch\n    ) {\n      return (this.currentSelection = null)\n    }\n    if (selection.head.line + selection.head.ch > selection.anchor.line + selection.anchor.ch) {\n      this.currentSelection = {\n        from: selection.anchor,\n        to: selection.head,\n      }\n    } else {\n      this.currentSelection = {\n        from: selection.head,\n        to: selection.anchor,\n      }\n    }\n  }\n\n  onMouseUp = () => {\n    if (this.currentSelection) {\n      this.setState({ selectionAt: this.currentSelection }, () => {\n        this.currentSelection = null\n      })\n    } else {\n      this.setState({ selectionAt: null })\n    }\n  }\n\n  onSelectionChange = changes => {\n    if (this.state.selectionAt) {\n      const css = [\n        changes.bold != null && `font-weight: ${changes.bold ? 'bold' : 'initial'}`,\n        changes.italics != null && `font-style: ${changes.italics ? 'italic' : 'initial'}`,\n        changes.underline != null && `text-decoration: ${getUnderline(changes.underline)}`,\n        changes.color != null && `color: ${changes.color} !important`,\n      ]\n        .filter(Boolean)\n        .join('; ')\n\n      if (css) {\n        this.props.editorRef.current.editor.doc.markText(\n          this.state.selectionAt.from,\n          this.state.selectionAt.to,\n          { css }\n        )\n      }\n    }\n  }\n\n  render() {\n    const config = { ...DEFAULT_SETTINGS, ...this.props.config }\n\n    const languageMode = this.handleLanguageChange(\n      this.props.children,\n      config.language && config.language.toLowerCase()\n    )\n\n    const options = {\n      screenReaderLabel: 'Code editor',\n      lineNumbers: config.lineNumbers,\n      firstLineNumber: config.firstLineNumber,\n      mode: languageMode || 'plaintext',\n      theme: config.theme,\n      scrollbarStyle: null,\n      viewportMargin: Infinity,\n      lineWrapping: true,\n      smartIndent: true,\n      extraKeys: {\n        'Shift-Tab': 'indentLess',\n      },\n      readOnly: this.props.readOnly,\n      showInvisibles: config.hiddenCharacters,\n    }\n    const backgroundImage =\n      (this.props.config.backgroundImage && this.props.config.backgroundImageSelection) ||\n      this.props.config.backgroundImage\n\n    const themeConfig = this.props.theme || THEMES_HASH[config.theme]\n\n    const light = themeConfig && themeConfig.light\n\n    /* eslint-disable jsx-a11y/no-static-element-interactions */\n    const content = (\n      <div className=\"container\">\n        {config.windowControls ? (\n          <WindowControls\n            theme={config.windowTheme}\n            code={this.props.children}\n            copyable={this.props.copyable}\n            light={light}\n          />\n        ) : null}\n        <CodeMirror\n          ref={this.props.editorRef}\n          className={`CodeMirror__container window-theme__${config.windowTheme}`}\n          value={this.props.children}\n          options={options}\n          onBeforeChange={this.onBeforeChange}\n          onGutterClick={this.props.onGutterClick}\n          onSelection={this.onSelection}\n        />\n        {config.watermark && <Watermark light={light} />}\n        <div className=\"container-bg\">\n          <div className=\"white eliminateOnRender\" />\n          <div className=\"alpha eliminateOnRender\" />\n          <div className=\"bg\" />\n        </div>\n\n        <WidthHandler\n          innerRef={this.props.innerRef}\n          onChange={this.props.updateWidth}\n          paddingHorizontal={config.paddingHorizontal}\n        />\n        <style jsx>\n          {`\n            .container {\n              position: relative;\n              min-width: ${config.widthAdjustment ? '90px' : 'auto'};\n              max-width: ${config.widthAdjustment ? '1024px' : 'none'};\n              ${config.widthAdjustment ? '' : `width: ${config.width}px;`}\n              padding: ${config.paddingVertical} ${config.paddingHorizontal};\n            }\n\n            .container :global(.watermark) {\n              fill-opacity: 0.75;\n              position: absolute;\n              z-index: 2;\n              bottom: calc(${config.paddingVertical} + 16px);\n              right: calc(${config.paddingHorizontal} + 16px);\n            }\n\n            .container .container-bg {\n              position: absolute;\n              top: 0px;\n              right: 0px;\n              bottom: 0px;\n              left: 0px;\n            }\n\n            .container .white {\n              background: #fff;\n              position: absolute;\n              top: 0px;\n              right: 0px;\n              bottom: 0px;\n              left: 0px;\n            }\n\n            .container .bg {\n              ${this.props.config.backgroundMode === 'image'\n                ? `background: url(${backgroundImage});\n                    background-size: cover;\n                    background-repeat: no-repeat;`\n                : `background: ${this.props.config.backgroundColor || config.backgroundColor};\n                    background-size: auto;\n                    background-repeat: repeat;`}\n              position: absolute;\n              top: 0px;\n              right: 0px;\n              bottom: 0px;\n              left: 0px;\n            }\n\n            .container .alpha {\n              position: absolute;\n              top: 0px;\n              right: 0px;\n              bottom: 0px;\n              left: 0px;\n              background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAMUlEQVQ4T2NkYGAQYcAP3uCTZhw1gGGYhAGBZIA/nYDCgBDAm9BGDWAAJyRCgLaBCAAgXwixzAS0pgAAAABJRU5ErkJggg==);\n            }\n\n            .container :global(.CodeMirror-gutters) {\n              background-color: unset;\n              border-right: none;\n            }\n\n            .container :global(.CodeMirror__container) {\n              min-width: inherit;\n              position: relative;\n              z-index: 1;\n              border-radius: 5px;\n              ${config.dropShadow\n                ? `box-shadow: 0 ${config.dropShadowOffsetY} ${config.dropShadowBlurRadius} rgba(0, 0, 0, 0.55)`\n                : ''};\n            }\n\n            .container :global(.CodeMirror__container .CodeMirror) {\n              height: auto;\n              min-width: inherit;\n              padding: 18px 18px;\n              padding-left: 12px;\n              ${config.lineNumbers ? 'padding-left: 12px;' : ''} border-radius: 5px;\n              font-family: ${config.fontFamily}, monospace !important;\n              font-size: ${config.fontSize};\n              line-height: ${config.lineHeight};\n              font-variant-ligatures: contextual;\n              font-feature-settings: 'calt' 1;\n              user-select: none;\n            }\n\n            .container :global(.CodeMirror-scroll),\n            .container :global(.CodeMirror-hscrollbar) {\n              overflow: hidden !important;\n            }\n\n            .container :global(.window-theme__sharp > .CodeMirror) {\n              border-radius: 0px;\n            }\n\n            .container :global(.window-theme__bw > .CodeMirror) {\n              border: 2px solid ${COLORS.SECONDARY};\n            }\n\n            .container :global(.window-controls + .CodeMirror__container > .CodeMirror) {\n              padding-top: 48px;\n            }\n\n            .container :global(.CodeMirror-linenumber) {\n              cursor: pointer;\n            }\n\n            .container :global(.CodeMirror-cursor) {\n              visibility: ${this.props.readOnly ? 'hidden' : ''};\n            }\n\n            @media (max-width: 768px) {\n              /* show cursor on mobile */\n              .container :global([contenteditable='true']) {\n                user-select: text;\n              }\n            }\n          `}\n        </style>\n      </div>\n    )\n\n    const selectionNode =\n      !this.props.readOnly &&\n      !!this.state.selectionAt &&\n      document.getElementById('style-editor-button')\n\n    return (\n      <div className=\"section\">\n        <div\n          ref={this.props.innerRef}\n          id=\"export-container\"\n          className=\"export-container\"\n          onMouseUp={this.onMouseUp}\n        >\n          <SpinnerWrapper loading={this.props.loading}>{content}</SpinnerWrapper>\n        </div>\n        {selectionNode &&\n          ReactDOM.createPortal(\n            <SelectionEditor onChange={this.onSelectionChange} />,\n            // TODO: don't use portal?\n            selectionNode\n          )}\n        <style jsx>\n          {`\n            .section,\n            .export-container {\n              height: 100%;\n              display: flex;\n              flex-direction: column;\n              justify-content: center;\n              align-items: center;\n              overflow: hidden;\n            }\n          `}\n        </style>\n      </div>\n    )\n  }\n}\n\nlet modesLoaded = false\nfunction useModeLoader() {\n  React.useEffect(() => {\n    if (!modesLoaded) {\n      LANGUAGES.filter(\n        language => language.mode && language.mode !== 'auto' && language.mode !== 'text'\n      ).forEach(language => {\n        language.custom\n          ? require(`../lib/custom/modes/${language.mode}`)\n          : require(`codemirror/mode/${language.mode}/${language.mode}`)\n      })\n      modesLoaded = true\n    }\n  }, [])\n}\n\nlet highLightsLoaded = false\nfunction useHighlightLoader() {\n  React.useEffect(() => {\n    if (!highLightsLoaded) {\n      import('../lib/highlight-languages')\n        .then(res => res.default.map(config => hljs.registerLanguage(config[0], config[1])))\n        .then(() => {\n          highLightsLoaded = true\n        })\n    }\n  }, [])\n}\n\nfunction selectedLinesReducer(\n  { prevLine, selected },\n  { type, lineNumber, numLines, selectedLines }\n) {\n  const newState = {}\n\n  switch (type) {\n    case 'GROUP': {\n      if (prevLine) {\n        for (let i = Math.min(prevLine, lineNumber); i < Math.max(prevLine, lineNumber) + 1; i++) {\n          newState[i] = selected[prevLine]\n        }\n      }\n      break\n    }\n    case 'MULTILINE': {\n      for (let i = 0; i < selectedLines.length; i++) {\n        newState[selectedLines[i] - 1] = true\n      }\n      break\n    }\n    default: {\n      for (let i = 0; i < numLines; i++) {\n        if (i != lineNumber) {\n          if (prevLine == null) {\n            newState[i] = false\n          }\n        } else {\n          newState[lineNumber] = selected[lineNumber] === true ? false : true\n        }\n      }\n    }\n  }\n\n  return {\n    selected: { ...selected, ...newState },\n    prevLine: lineNumber,\n  }\n}\n\nfunction useSelectedLines(props, editorRef) {\n  const [state, dispatch] = React.useReducer(selectedLinesReducer, {\n    prevLine: null,\n    selected: {},\n  })\n\n  React.useEffect(() => {\n    if (editorRef.current && Object.keys(state.selected).length > 0) {\n      editorRef.current.editor.display.view.forEach((line, i) => {\n        if (line.text) {\n          line.text.style.opacity = state.selected[i] === true ? 1 : 0.5\n        }\n        if (line.gutter) {\n          line.gutter.style.opacity = state.selected[i] === true ? 1 : 0.5\n        }\n      })\n    }\n  }, [state.selected, props.children, props.config, editorRef])\n\n  React.useEffect(() => {\n    if (props.config.selectedLines) {\n      dispatch({\n        type: 'MULTILINE',\n        selectedLines: props.config.selectedLines,\n      })\n    }\n  }, [props.config.selectedLines])\n\n  return React.useCallback(function onGutterClick(editor, lineNumber, gutter, e) {\n    const numLines = editor.display.view.length\n    const type = e.shiftKey ? 'GROUP' : 'LINE'\n    dispatch({ type, lineNumber, numLines })\n  }, [])\n}\n\nfunction useShowInvisiblesLoader() {\n  React.useEffect(() => void require('cm-show-invisibles'), [])\n}\n\nfunction CarbonContainer(props, ref) {\n  useModeLoader()\n  useHighlightLoader()\n  useShowInvisiblesLoader()\n  const editorRef = React.createRef()\n  const onGutterClick = useSelectedLines(props, editorRef)\n\n  return <Carbon {...props} innerRef={ref} editorRef={editorRef} onGutterClick={onGutterClick} />\n}\n\nexport default React.forwardRef(CarbonContainer)\n"]},"metadata":{},"sourceType":"module"}