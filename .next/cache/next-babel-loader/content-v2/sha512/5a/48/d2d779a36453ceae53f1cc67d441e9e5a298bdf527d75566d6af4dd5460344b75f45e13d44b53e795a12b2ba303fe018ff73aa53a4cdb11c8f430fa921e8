{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/Users/limengyu/Desktop/private/code/project/show-codes/components/ExportMenu.js\";\nimport _JSXStyle from \"styled-jsx/style\";\nimport React from 'react';\nimport { useOnline, useKeyboardListener, useAsyncCallback } from 'actionsack';\nimport { COLORS, EXPORT_SIZES } from '../lib/constants';\nimport Button from './Button';\nimport Input from './Input';\nimport Popout, { managePopout } from './Popout';\nimport { Down as ArrowDown } from './svg/Arrows';\nconst MAX_PAYLOAD_SIZE = 5e6; // bytes\n\nfunction verifyPayloadSize(str) {\n  if (typeof str !== 'string') return true;\n\n  if (false) {\n    return new Blob([str]).size < MAX_PAYLOAD_SIZE;\n  }\n\n  return Buffer.byteLength(str, 'utf8');\n}\n\nconst popoutStyle = {\n  width: '256px',\n  right: 0\n};\n\nfunction useSafari() {\n  const [isSafari, setSafari] = React.useState(false);\n  React.useEffect(() => {\n    setSafari(window.navigator && window.navigator.userAgent.indexOf('Safari') !== -1 && window.navigator.userAgent.indexOf('Chrome') === -1);\n  }, []);\n  return isSafari;\n}\n\nfunction preventDefault(fn) {\n  return e => {\n    e.preventDefault();\n    return fn(e);\n  };\n}\n\nfunction ExportMenu({\n  backgroundImage,\n  onChange,\n  exportSize,\n  isVisible,\n  toggleVisibility,\n  exportImage: exp\n}) {\n  const tooLarge = React.useMemo(() => !verifyPayloadSize(backgroundImage), [backgroundImage]);\n  const online = useOnline();\n  const isSafari = useSafari();\n  const input = React.useRef();\n  const [exportImage, {\n    loading\n  }] = useAsyncCallback(exp);\n  const disablePNG = isSafari && (tooLarge || !online);\n\n  const handleExportSizeChange = selectedSize => () => onChange('exportSize', selectedSize);\n\n  const handleExport = format => () => exportImage(format, {\n    filename: input.current && input.current.value\n  });\n\n  useKeyboardListener('⌘-⇧-e', preventDefault(handleExport('png')));\n  useKeyboardListener('⌘-⇧-s', preventDefault(handleExport('svg')));\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: _JSXStyle.dynamic([[\"1321746742\", [COLORS.PURPLE, COLORS.PURPLE, COLORS.PURPLE, COLORS.PURPLE]]]) + \" \" + \"export-menu-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: _JSXStyle.dynamic([[\"1321746742\", [COLORS.PURPLE, COLORS.PURPLE, COLORS.PURPLE, COLORS.PURPLE]]]) + \" \" + \"flex\",\n      children: [/*#__PURE__*/_jsxDEV(Button, {\n        border: true,\n        large: true,\n        center: true,\n        color: COLORS.PURPLE,\n        onClick: handleExport('png'),\n        \"data-cy\": \"quick-export-button\",\n        style: {\n          minWidth: 92,\n          borderBottomRightRadius: 0,\n          borderTopRightRadius: 0\n        },\n        title: \"Quick export\",\n        children: loading ? 'Exporting…' : 'Export'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        id: \"export-menu\",\n        border: true,\n        large: true,\n        center: true,\n        color: COLORS.PURPLE,\n        padding: \"0 8px\",\n        onClick: toggleVisibility,\n        \"data-cy\": \"export-button\",\n        margin: \"0 0 0 -1px\",\n        style: {\n          borderBottomLeftRadius: 0,\n          borderTopLeftRadius: 0\n        },\n        title: \"Export menu dropdown\",\n        children: /*#__PURE__*/_jsxDEV(ArrowDown, {\n          color: COLORS.PURPLE\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 99,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Popout, {\n      hidden: !isVisible,\n      borderColor: COLORS.PURPLE,\n      pointerRight: \"6px\",\n      style: popoutStyle,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: _JSXStyle.dynamic([[\"1321746742\", [COLORS.PURPLE, COLORS.PURPLE, COLORS.PURPLE, COLORS.PURPLE]]]) + \" \" + \"export-row\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: _JSXStyle.dynamic([[\"1321746742\", [COLORS.PURPLE, COLORS.PURPLE, COLORS.PURPLE, COLORS.PURPLE]]]) + \" \" + \"filename\",\n          children: \"File name\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Input, {\n          ref: input,\n          title: \"filename\",\n          placeholder: \"carbon\",\n          color: COLORS.PURPLE\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: _JSXStyle.dynamic([[\"1321746742\", [COLORS.PURPLE, COLORS.PURPLE, COLORS.PURPLE, COLORS.PURPLE]]]) + \" \" + \"export-row\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: _JSXStyle.dynamic([[\"1321746742\", [COLORS.PURPLE, COLORS.PURPLE, COLORS.PURPLE, COLORS.PURPLE]]]),\n          children: \"Size\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: _JSXStyle.dynamic([[\"1321746742\", [COLORS.PURPLE, COLORS.PURPLE, COLORS.PURPLE, COLORS.PURPLE]]]) + \" \" + \"flex\",\n          children: EXPORT_SIZES.map(({\n            name\n          }, i) => /*#__PURE__*/_jsxDEV(Button, {\n            center: true,\n            hoverColor: COLORS.PURPLE,\n            margin: i === EXPORT_SIZES.length - 1 ? 0 : '0 10px 0 0',\n            color: exportSize === name ? COLORS.PURPLE : COLORS.DARK_PURPLE,\n            onClick: handleExportSizeChange(name),\n            children: name\n          }, name, false, {\n            fileName: _jsxFileName,\n            lineNumber: 116,\n            columnNumber: 15\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: _JSXStyle.dynamic([[\"1321746742\", [COLORS.PURPLE, COLORS.PURPLE, COLORS.PURPLE, COLORS.PURPLE]]]) + \" \" + \"export-row\",\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          center: true,\n          color: COLORS.PURPLE,\n          onClick: handleExport('open'),\n          children: \"Open\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: _JSXStyle.dynamic([[\"1321746742\", [COLORS.PURPLE, COLORS.PURPLE, COLORS.PURPLE, COLORS.PURPLE]]]) + \" \" + \"save-container\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: _JSXStyle.dynamic([[\"1321746742\", [COLORS.PURPLE, COLORS.PURPLE, COLORS.PURPLE, COLORS.PURPLE]]]),\n            children: \"Download\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 134,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: _JSXStyle.dynamic([[\"1321746742\", [COLORS.PURPLE, COLORS.PURPLE, COLORS.PURPLE, COLORS.PURPLE]]]),\n            children: [!disablePNG && /*#__PURE__*/_jsxDEV(Button, {\n              center: true,\n              margin: \"0 8px 0 0\",\n              hoverColor: COLORS.PURPLE,\n              color: COLORS.DARK_PURPLE,\n              onClick: handleExport('png'),\n              id: \"export-png\",\n              disabled: loading,\n              children: \"PNG\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 137,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(Button, {\n              center: true,\n              hoverColor: COLORS.PURPLE,\n              color: COLORS.DARK_PURPLE,\n              onClick: handleExport('svg'),\n              id: \"export-svg\",\n              disabled: loading,\n              children: \"SVG\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 149,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 135,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(_JSXStyle, {\n      id: \"1321746742\",\n      dynamic: [COLORS.PURPLE, COLORS.PURPLE, COLORS.PURPLE, COLORS.PURPLE],\n      children: `.export-menu-container.__jsx-style-dynamic-selector{position:relative;color:${COLORS.PURPLE};-webkit-flex:1;-ms-flex:1;flex:1;}.export-row.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;padding:8px 16px;border-bottom:1px solid ${COLORS.PURPLE};}.export-row.__jsx-style-dynamic-selector>button{border-right:1px solid ${COLORS.PURPLE};}.export-row.__jsx-style-dynamic-selector:last-child{border-bottom:none;padding:0;}.filename.__jsx-style-dynamic-selector{-webkit-flex-basis:72px;-ms-flex-preferred-size:72px;flex-basis:72px;}.save-container.__jsx-style-dynamic-selector{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex:1;-ms-flex:1;flex:1;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:12px 16px;}.save-container.__jsx-style-dynamic-selector>div.__jsx-style-dynamic-selector{margin-top:6px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex:1;-ms-flex:1;flex:1;}.save-container.__jsx-style-dynamic-selector:first-of-type{padding:12px 12px;border-right:1px solid ${COLORS.PURPLE};}\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9saW1lbmd5dS9EZXNrdG9wL3ByaXZhdGUvY29kZS9wcm9qZWN0L3Nob3ctY29kZXMvY29tcG9uZW50cy9FeHBvcnRNZW51LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQW1LUyxBQUcrQixBQU1MLEFBT3VDLEFBR2pDLEFBS0gsQUFJSCxBQVFFLEFBS0csZUFKTCxHQWpDc0IsQUFzQ2lCLENBdEIxQyxVQUNaLHVCQUpBLENBWlMsZ0JBb0JULENBa0JBLElBakNxQixBQW1CWixZQXZCVCxHQWdDUyxrQkFSZSxlQVN4Qiw2Q0E1QmdDLGtCQW9CUCxpR0FuQk4sRUFvQkUsZUFuQmtDLHFEQUN2RCx5QkFtQm9CLGtCQUNwQiIsImZpbGUiOiIvVXNlcnMvbGltZW5neXUvRGVza3RvcC9wcml2YXRlL2NvZGUvcHJvamVjdC9zaG93LWNvZGVzL2NvbXBvbmVudHMvRXhwb3J0TWVudS5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCdcbmltcG9ydCB7IHVzZU9ubGluZSwgdXNlS2V5Ym9hcmRMaXN0ZW5lciwgdXNlQXN5bmNDYWxsYmFjayB9IGZyb20gJ2FjdGlvbnNhY2snXG5cbmltcG9ydCB7IENPTE9SUywgRVhQT1JUX1NJWkVTIH0gZnJvbSAnLi4vbGliL2NvbnN0YW50cydcbmltcG9ydCBCdXR0b24gZnJvbSAnLi9CdXR0b24nXG5pbXBvcnQgSW5wdXQgZnJvbSAnLi9JbnB1dCdcbmltcG9ydCBQb3BvdXQsIHsgbWFuYWdlUG9wb3V0IH0gZnJvbSAnLi9Qb3BvdXQnXG5cbmltcG9ydCB7IERvd24gYXMgQXJyb3dEb3duIH0gZnJvbSAnLi9zdmcvQXJyb3dzJ1xuXG5jb25zdCBNQVhfUEFZTE9BRF9TSVpFID0gNWU2IC8vIGJ5dGVzXG5mdW5jdGlvbiB2ZXJpZnlQYXlsb2FkU2l6ZShzdHIpIHtcbiAgaWYgKHR5cGVvZiBzdHIgIT09ICdzdHJpbmcnKSByZXR1cm4gdHJ1ZVxuXG4gIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xuICAgIHJldHVybiBuZXcgQmxvYihbc3RyXSkuc2l6ZSA8IE1BWF9QQVlMT0FEX1NJWkVcbiAgfVxuXG4gIHJldHVybiBCdWZmZXIuYnl0ZUxlbmd0aChzdHIsICd1dGY4Jylcbn1cblxuY29uc3QgcG9wb3V0U3R5bGUgPSB7IHdpZHRoOiAnMjU2cHgnLCByaWdodDogMCB9XG5cbmZ1bmN0aW9uIHVzZVNhZmFyaSgpIHtcbiAgY29uc3QgW2lzU2FmYXJpLCBzZXRTYWZhcmldID0gUmVhY3QudXNlU3RhdGUoZmFsc2UpXG4gIFJlYWN0LnVzZUVmZmVjdCgoKSA9PiB7XG4gICAgc2V0U2FmYXJpKFxuICAgICAgd2luZG93Lm5hdmlnYXRvciAmJlxuICAgICAgICB3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCdTYWZhcmknKSAhPT0gLTEgJiZcbiAgICAgICAgd2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZignQ2hyb21lJykgPT09IC0xXG4gICAgKVxuICB9LCBbXSlcblxuICByZXR1cm4gaXNTYWZhcmlcbn1cblxuZnVuY3Rpb24gcHJldmVudERlZmF1bHQoZm4pIHtcbiAgcmV0dXJuIGUgPT4ge1xuICAgIGUucHJldmVudERlZmF1bHQoKVxuICAgIHJldHVybiBmbihlKVxuICB9XG59XG5cbmZ1bmN0aW9uIEV4cG9ydE1lbnUoe1xuICBiYWNrZ3JvdW5kSW1hZ2UsXG4gIG9uQ2hhbmdlLFxuICBleHBvcnRTaXplLFxuICBpc1Zpc2libGUsXG4gIHRvZ2dsZVZpc2liaWxpdHksXG4gIGV4cG9ydEltYWdlOiBleHAsXG59KSB7XG4gIGNvbnN0IHRvb0xhcmdlID0gUmVhY3QudXNlTWVtbygoKSA9PiAhdmVyaWZ5UGF5bG9hZFNpemUoYmFja2dyb3VuZEltYWdlKSwgW2JhY2tncm91bmRJbWFnZV0pXG4gIGNvbnN0IG9ubGluZSA9IHVzZU9ubGluZSgpXG4gIGNvbnN0IGlzU2FmYXJpID0gdXNlU2FmYXJpKClcbiAgY29uc3QgaW5wdXQgPSBSZWFjdC51c2VSZWYoKVxuXG4gIGNvbnN0IFtleHBvcnRJbWFnZSwgeyBsb2FkaW5nIH1dID0gdXNlQXN5bmNDYWxsYmFjayhleHApXG5cbiAgY29uc3QgZGlzYWJsZVBORyA9IGlzU2FmYXJpICYmICh0b29MYXJnZSB8fCAhb25saW5lKVxuXG4gIGNvbnN0IGhhbmRsZUV4cG9ydFNpemVDaGFuZ2UgPSBzZWxlY3RlZFNpemUgPT4gKCkgPT4gb25DaGFuZ2UoJ2V4cG9ydFNpemUnLCBzZWxlY3RlZFNpemUpXG5cbiAgY29uc3QgaGFuZGxlRXhwb3J0ID0gZm9ybWF0ID0+ICgpID0+XG4gICAgZXhwb3J0SW1hZ2UoZm9ybWF0LCB7XG4gICAgICBmaWxlbmFtZTogaW5wdXQuY3VycmVudCAmJiBpbnB1dC5jdXJyZW50LnZhbHVlLFxuICAgIH0pXG5cbiAgdXNlS2V5Ym9hcmRMaXN0ZW5lcign4oyYLeKHpy1lJywgcHJldmVudERlZmF1bHQoaGFuZGxlRXhwb3J0KCdwbmcnKSkpXG4gIHVzZUtleWJvYXJkTGlzdGVuZXIoJ+KMmC3ih6ctcycsIHByZXZlbnREZWZhdWx0KGhhbmRsZUV4cG9ydCgnc3ZnJykpKVxuXG4gIHJldHVybiAoXG4gICAgPGRpdiBjbGFzc05hbWU9XCJleHBvcnQtbWVudS1jb250YWluZXJcIj5cbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleFwiPlxuICAgICAgICA8QnV0dG9uXG4gICAgICAgICAgYm9yZGVyXG4gICAgICAgICAgbGFyZ2VcbiAgICAgICAgICBjZW50ZXJcbiAgICAgICAgICBjb2xvcj17Q09MT1JTLlBVUlBMRX1cbiAgICAgICAgICBvbkNsaWNrPXtoYW5kbGVFeHBvcnQoJ3BuZycpfVxuICAgICAgICAgIGRhdGEtY3k9XCJxdWljay1leHBvcnQtYnV0dG9uXCJcbiAgICAgICAgICBzdHlsZT17eyBtaW5XaWR0aDogOTIsIGJvcmRlckJvdHRvbVJpZ2h0UmFkaXVzOiAwLCBib3JkZXJUb3BSaWdodFJhZGl1czogMCB9fVxuICAgICAgICAgIHRpdGxlPVwiUXVpY2sgZXhwb3J0XCJcbiAgICAgICAgPlxuICAgICAgICAgIHtsb2FkaW5nID8gJ0V4cG9ydGluZ+KApicgOiAnRXhwb3J0J31cbiAgICAgICAgPC9CdXR0b24+XG4gICAgICAgIDxCdXR0b25cbiAgICAgICAgICBpZD1cImV4cG9ydC1tZW51XCJcbiAgICAgICAgICBib3JkZXJcbiAgICAgICAgICBsYXJnZVxuICAgICAgICAgIGNlbnRlclxuICAgICAgICAgIGNvbG9yPXtDT0xPUlMuUFVSUExFfVxuICAgICAgICAgIHBhZGRpbmc9XCIwIDhweFwiXG4gICAgICAgICAgb25DbGljaz17dG9nZ2xlVmlzaWJpbGl0eX1cbiAgICAgICAgICBkYXRhLWN5PVwiZXhwb3J0LWJ1dHRvblwiXG4gICAgICAgICAgbWFyZ2luPVwiMCAwIDAgLTFweFwiXG4gICAgICAgICAgc3R5bGU9e3sgYm9yZGVyQm90dG9tTGVmdFJhZGl1czogMCwgYm9yZGVyVG9wTGVmdFJhZGl1czogMCB9fVxuICAgICAgICAgIHRpdGxlPVwiRXhwb3J0IG1lbnUgZHJvcGRvd25cIlxuICAgICAgICA+XG4gICAgICAgICAgPEFycm93RG93biBjb2xvcj17Q09MT1JTLlBVUlBMRX0gLz5cbiAgICAgICAgPC9CdXR0b24+XG4gICAgICA8L2Rpdj5cbiAgICAgIDxQb3BvdXRcbiAgICAgICAgaGlkZGVuPXshaXNWaXNpYmxlfVxuICAgICAgICBib3JkZXJDb2xvcj17Q09MT1JTLlBVUlBMRX1cbiAgICAgICAgcG9pbnRlclJpZ2h0PVwiNnB4XCJcbiAgICAgICAgc3R5bGU9e3BvcG91dFN0eWxlfVxuICAgICAgPlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImV4cG9ydC1yb3dcIj5cbiAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJmaWxlbmFtZVwiPkZpbGUgbmFtZTwvc3Bhbj5cbiAgICAgICAgICA8SW5wdXQgcmVmPXtpbnB1dH0gdGl0bGU9XCJmaWxlbmFtZVwiIHBsYWNlaG9sZGVyPVwiY2FyYm9uXCIgY29sb3I9e0NPTE9SUy5QVVJQTEV9IC8+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImV4cG9ydC1yb3dcIj5cbiAgICAgICAgICA8c3Bhbj5TaXplPC9zcGFuPlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleFwiPlxuICAgICAgICAgICAge0VYUE9SVF9TSVpFUy5tYXAoKHsgbmFtZSB9LCBpKSA9PiAoXG4gICAgICAgICAgICAgIDxCdXR0b25cbiAgICAgICAgICAgICAgICBjZW50ZXJcbiAgICAgICAgICAgICAgICBrZXk9e25hbWV9XG4gICAgICAgICAgICAgICAgaG92ZXJDb2xvcj17Q09MT1JTLlBVUlBMRX1cbiAgICAgICAgICAgICAgICBtYXJnaW49e2kgPT09IEVYUE9SVF9TSVpFUy5sZW5ndGggLSAxID8gMCA6ICcwIDEwcHggMCAwJ31cbiAgICAgICAgICAgICAgICBjb2xvcj17ZXhwb3J0U2l6ZSA9PT0gbmFtZSA/IENPTE9SUy5QVVJQTEUgOiBDT0xPUlMuREFSS19QVVJQTEV9XG4gICAgICAgICAgICAgICAgb25DbGljaz17aGFuZGxlRXhwb3J0U2l6ZUNoYW5nZShuYW1lKX1cbiAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIHtuYW1lfVxuICAgICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICAgICkpfVxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJleHBvcnQtcm93XCI+XG4gICAgICAgICAgPEJ1dHRvbiBjZW50ZXIgY29sb3I9e0NPTE9SUy5QVVJQTEV9IG9uQ2xpY2s9e2hhbmRsZUV4cG9ydCgnb3BlbicpfT5cbiAgICAgICAgICAgIE9wZW5cbiAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInNhdmUtY29udGFpbmVyXCI+XG4gICAgICAgICAgICA8c3Bhbj5Eb3dubG9hZDwvc3Bhbj5cbiAgICAgICAgICAgIDxkaXY+XG4gICAgICAgICAgICAgIHshZGlzYWJsZVBORyAmJiAoXG4gICAgICAgICAgICAgICAgPEJ1dHRvblxuICAgICAgICAgICAgICAgICAgY2VudGVyXG4gICAgICAgICAgICAgICAgICBtYXJnaW49XCIwIDhweCAwIDBcIlxuICAgICAgICAgICAgICAgICAgaG92ZXJDb2xvcj17Q09MT1JTLlBVUlBMRX1cbiAgICAgICAgICAgICAgICAgIGNvbG9yPXtDT0xPUlMuREFSS19QVVJQTEV9XG4gICAgICAgICAgICAgICAgICBvbkNsaWNrPXtoYW5kbGVFeHBvcnQoJ3BuZycpfVxuICAgICAgICAgICAgICAgICAgaWQ9XCJleHBvcnQtcG5nXCJcbiAgICAgICAgICAgICAgICAgIGRpc2FibGVkPXtsb2FkaW5nfVxuICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgIFBOR1xuICAgICAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICA8QnV0dG9uXG4gICAgICAgICAgICAgICAgY2VudGVyXG4gICAgICAgICAgICAgICAgaG92ZXJDb2xvcj17Q09MT1JTLlBVUlBMRX1cbiAgICAgICAgICAgICAgICBjb2xvcj17Q09MT1JTLkRBUktfUFVSUExFfVxuICAgICAgICAgICAgICAgIG9uQ2xpY2s9e2hhbmRsZUV4cG9ydCgnc3ZnJyl9XG4gICAgICAgICAgICAgICAgaWQ9XCJleHBvcnQtc3ZnXCJcbiAgICAgICAgICAgICAgICBkaXNhYmxlZD17bG9hZGluZ31cbiAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIFNWR1xuICAgICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvUG9wb3V0PlxuICAgICAgPHN0eWxlIGpzeD5cbiAgICAgICAge2BcbiAgICAgICAgICAuZXhwb3J0LW1lbnUtY29udGFpbmVyIHtcbiAgICAgICAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgICAgICAgICAgIGNvbG9yOiAke0NPTE9SUy5QVVJQTEV9O1xuICAgICAgICAgICAgZmxleDogMTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAuZXhwb3J0LXJvdyB7XG4gICAgICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgICAgICAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjtcbiAgICAgICAgICAgIHBhZGRpbmc6IDhweCAxNnB4O1xuICAgICAgICAgICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkICR7Q09MT1JTLlBVUlBMRX07XG4gICAgICAgICAgfVxuICAgICAgICAgIC5leHBvcnQtcm93ID4gOmdsb2JhbChidXR0b24pIHtcbiAgICAgICAgICAgIGJvcmRlci1yaWdodDogMXB4IHNvbGlkICR7Q09MT1JTLlBVUlBMRX07XG4gICAgICAgICAgfVxuICAgICAgICAgIC5leHBvcnQtcm93Omxhc3QtY2hpbGQge1xuICAgICAgICAgICAgYm9yZGVyLWJvdHRvbTogbm9uZTtcbiAgICAgICAgICAgIHBhZGRpbmc6IDA7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLmZpbGVuYW1lIHtcbiAgICAgICAgICAgIGZsZXgtYmFzaXM6IDcycHg7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLnNhdmUtY29udGFpbmVyIHtcbiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgICAgICBmbGV4OiAxO1xuICAgICAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcbiAgICAgICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgICAgICAgIHBhZGRpbmc6IDEycHggMTZweDtcbiAgICAgICAgICB9XG4gICAgICAgICAgLnNhdmUtY29udGFpbmVyID4gZGl2IHtcbiAgICAgICAgICAgIG1hcmdpbi10b3A6IDZweDtcbiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgICAgICBmbGV4OiAxO1xuICAgICAgICAgIH1cbiAgICAgICAgICAuc2F2ZS1jb250YWluZXI6Zmlyc3Qtb2YtdHlwZSB7XG4gICAgICAgICAgICBwYWRkaW5nOiAxMnB4IDEycHg7XG4gICAgICAgICAgICBib3JkZXItcmlnaHQ6IDFweCBzb2xpZCAke0NPTE9SUy5QVVJQTEV9O1xuICAgICAgICAgIH1cbiAgICAgICAgYH1cbiAgICAgIDwvc3R5bGU+XG4gICAgPC9kaXY+XG4gIClcbn1cblxuZXhwb3J0IGRlZmF1bHQgbWFuYWdlUG9wb3V0KFJlYWN0Lm1lbW8oRXhwb3J0TWVudSkpXG4iXX0= */\n/*@ sourceURL=/Users/limengyu/Desktop/private/code/project/show-codes/components/ExportMenu.js */`\n    }, void 0, false, void 0, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 72,\n    columnNumber: 5\n  }, this);\n}\n\nexport default managePopout( /*#__PURE__*/React.memo(ExportMenu));","map":{"version":3,"sources":["/Users/limengyu/Desktop/private/code/project/show-codes/components/ExportMenu.js"],"names":["React","useOnline","useKeyboardListener","useAsyncCallback","COLORS","EXPORT_SIZES","Button","Input","Popout","managePopout","Down","ArrowDown","MAX_PAYLOAD_SIZE","verifyPayloadSize","str","Blob","size","Buffer","byteLength","popoutStyle","width","right","useSafari","isSafari","setSafari","useState","useEffect","window","navigator","userAgent","indexOf","preventDefault","fn","e","ExportMenu","backgroundImage","onChange","exportSize","isVisible","toggleVisibility","exportImage","exp","tooLarge","useMemo","online","input","useRef","loading","disablePNG","handleExportSizeChange","selectedSize","handleExport","format","filename","current","value","PURPLE","minWidth","borderBottomRightRadius","borderTopRightRadius","borderBottomLeftRadius","borderTopLeftRadius","map","name","i","length","DARK_PURPLE","memo"],"mappings":"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","sourcesContent":["import React from 'react'\nimport { useOnline, useKeyboardListener, useAsyncCallback } from 'actionsack'\n\nimport { COLORS, EXPORT_SIZES } from '../lib/constants'\nimport Button from './Button'\nimport Input from './Input'\nimport Popout, { managePopout } from './Popout'\n\nimport { Down as ArrowDown } from './svg/Arrows'\n\nconst MAX_PAYLOAD_SIZE = 5e6 // bytes\nfunction verifyPayloadSize(str) {\n  if (typeof str !== 'string') return true\n\n  if (typeof window !== 'undefined') {\n    return new Blob([str]).size < MAX_PAYLOAD_SIZE\n  }\n\n  return Buffer.byteLength(str, 'utf8')\n}\n\nconst popoutStyle = { width: '256px', right: 0 }\n\nfunction useSafari() {\n  const [isSafari, setSafari] = React.useState(false)\n  React.useEffect(() => {\n    setSafari(\n      window.navigator &&\n        window.navigator.userAgent.indexOf('Safari') !== -1 &&\n        window.navigator.userAgent.indexOf('Chrome') === -1\n    )\n  }, [])\n\n  return isSafari\n}\n\nfunction preventDefault(fn) {\n  return e => {\n    e.preventDefault()\n    return fn(e)\n  }\n}\n\nfunction ExportMenu({\n  backgroundImage,\n  onChange,\n  exportSize,\n  isVisible,\n  toggleVisibility,\n  exportImage: exp,\n}) {\n  const tooLarge = React.useMemo(() => !verifyPayloadSize(backgroundImage), [backgroundImage])\n  const online = useOnline()\n  const isSafari = useSafari()\n  const input = React.useRef()\n\n  const [exportImage, { loading }] = useAsyncCallback(exp)\n\n  const disablePNG = isSafari && (tooLarge || !online)\n\n  const handleExportSizeChange = selectedSize => () => onChange('exportSize', selectedSize)\n\n  const handleExport = format => () =>\n    exportImage(format, {\n      filename: input.current && input.current.value,\n    })\n\n  useKeyboardListener('⌘-⇧-e', preventDefault(handleExport('png')))\n  useKeyboardListener('⌘-⇧-s', preventDefault(handleExport('svg')))\n\n  return (\n    <div className=\"export-menu-container\">\n      <div className=\"flex\">\n        <Button\n          border\n          large\n          center\n          color={COLORS.PURPLE}\n          onClick={handleExport('png')}\n          data-cy=\"quick-export-button\"\n          style={{ minWidth: 92, borderBottomRightRadius: 0, borderTopRightRadius: 0 }}\n          title=\"Quick export\"\n        >\n          {loading ? 'Exporting…' : 'Export'}\n        </Button>\n        <Button\n          id=\"export-menu\"\n          border\n          large\n          center\n          color={COLORS.PURPLE}\n          padding=\"0 8px\"\n          onClick={toggleVisibility}\n          data-cy=\"export-button\"\n          margin=\"0 0 0 -1px\"\n          style={{ borderBottomLeftRadius: 0, borderTopLeftRadius: 0 }}\n          title=\"Export menu dropdown\"\n        >\n          <ArrowDown color={COLORS.PURPLE} />\n        </Button>\n      </div>\n      <Popout\n        hidden={!isVisible}\n        borderColor={COLORS.PURPLE}\n        pointerRight=\"6px\"\n        style={popoutStyle}\n      >\n        <div className=\"export-row\">\n          <span className=\"filename\">File name</span>\n          <Input ref={input} title=\"filename\" placeholder=\"carbon\" color={COLORS.PURPLE} />\n        </div>\n        <div className=\"export-row\">\n          <span>Size</span>\n          <div className=\"flex\">\n            {EXPORT_SIZES.map(({ name }, i) => (\n              <Button\n                center\n                key={name}\n                hoverColor={COLORS.PURPLE}\n                margin={i === EXPORT_SIZES.length - 1 ? 0 : '0 10px 0 0'}\n                color={exportSize === name ? COLORS.PURPLE : COLORS.DARK_PURPLE}\n                onClick={handleExportSizeChange(name)}\n              >\n                {name}\n              </Button>\n            ))}\n          </div>\n        </div>\n        <div className=\"export-row\">\n          <Button center color={COLORS.PURPLE} onClick={handleExport('open')}>\n            Open\n          </Button>\n          <div className=\"save-container\">\n            <span>Download</span>\n            <div>\n              {!disablePNG && (\n                <Button\n                  center\n                  margin=\"0 8px 0 0\"\n                  hoverColor={COLORS.PURPLE}\n                  color={COLORS.DARK_PURPLE}\n                  onClick={handleExport('png')}\n                  id=\"export-png\"\n                  disabled={loading}\n                >\n                  PNG\n                </Button>\n              )}\n              <Button\n                center\n                hoverColor={COLORS.PURPLE}\n                color={COLORS.DARK_PURPLE}\n                onClick={handleExport('svg')}\n                id=\"export-svg\"\n                disabled={loading}\n              >\n                SVG\n              </Button>\n            </div>\n          </div>\n        </div>\n      </Popout>\n      <style jsx>\n        {`\n          .export-menu-container {\n            position: relative;\n            color: ${COLORS.PURPLE};\n            flex: 1;\n          }\n\n          .export-row {\n            display: flex;\n            align-items: center;\n            justify-content: space-between;\n            padding: 8px 16px;\n            border-bottom: 1px solid ${COLORS.PURPLE};\n          }\n          .export-row > :global(button) {\n            border-right: 1px solid ${COLORS.PURPLE};\n          }\n          .export-row:last-child {\n            border-bottom: none;\n            padding: 0;\n          }\n\n          .filename {\n            flex-basis: 72px;\n          }\n\n          .save-container {\n            display: flex;\n            flex: 1;\n            flex-direction: column;\n            justify-content: center;\n            align-items: center;\n            padding: 12px 16px;\n          }\n          .save-container > div {\n            margin-top: 6px;\n            display: flex;\n            flex: 1;\n          }\n          .save-container:first-of-type {\n            padding: 12px 12px;\n            border-right: 1px solid ${COLORS.PURPLE};\n          }\n        `}\n      </style>\n    </div>\n  )\n}\n\nexport default managePopout(React.memo(ExportMenu))\n"]},"metadata":{},"sourceType":"module"}